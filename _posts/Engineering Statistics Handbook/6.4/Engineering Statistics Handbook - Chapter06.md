## 6.4. 시계열 분석 입문
산업 공정을 모니터링하거나 기업의 사업 지표를 추적할 때 종종 시계열 데이터를 접한다. 데이터를 시계열을 다루는 방법으로 모델링하는 것과 공정을 모니터링하는 방법(이 장의 앞 부분에서 다룬)에는 다음과 같은 중요한 차이점이 있다.

> 시계열 분석은 시간에 따라 수집한 데이터를 설명한다. 이러한 데이터에는 꼭 고려해야 할 자기상관(autocorrelation), 추세(trend), 계절적인 변화(seasonal variation) 같은 내부 구조가 있을 수 있다.
  * 문자적인 계절이 아니다.

이 절(section)에서는 급성장하는 시계열 분석과 모델링 분야에서 많은 이들이 사용하는 기법들을 간략하게 설명하겠다.

다음과 같은 내용을 다룬다.

1. 정의, 응용, 기법

2. 이동 평균과 평활법이란?
  1. 단일 이동 평균
  2. 중앙 이동 평균

3. 지수 평활법이란?
  1. 단일 지수 평활법
  2. 단일 지수 평활법을 통한 예측
  3. 이중 지수 평활법
  4. 이중 지수 평활법을 통한 예측
  5. 삼중 지수 평활법
  6. 삼중 지수 평활법 예제
  7. 지수 평활법 요약

4. 단변량 시계열 모델
  1. 표본 데이터
  2. 정상성(Stationarity)
  3. 계절성(Seasonality)
  4. 일반적인 접근법
  5. 박스-젠킨스(Box-Jenkins) 접근법
  6. 박스-젠킨스 모델 판별
  7. 박스-젠킨스 모델 측정
  8. 박스-젠킨스 모델 검증
  9. 단변량 박스-젠킨스 분석 예제
  10. 계절성 데이터에 대한 박스-젠킨스 모델 분석

5. 다변량 시게열 모델
  1. 다변량 시계열 분석의 예


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc4.htm


## 6.4.1 정의, 응용, 기법
### 정의
**시계열의 정의:** 시간 순서에 따라 정렬된 변수값의 수열. 이 때, 나눈 시간 간격은 정확하게 같다.

### 산업 데이터에서 시계열을 종종 접한다
**응용:** 시계열 모델은 두 경우에 사용한다.
  * 관측 데이터를 주는 원인과 구조를 이해하기 위해.
  * 모델을 맞추고, 예측이나 되먹임(feedback)/앞먹임(feedforward) 제어를 모니터링 하기 위해.

시계열 분석 응용 예시
  * 경제 예측
  * 판매 예측
  * 예산 분석
  * 주식 시장 분석
  * 수익 추정
  * 공정과 품질 관리
  * 재고 상황 연구
  * 업무량 추정
  * 공익사업 연구
  * 인구 조사 분석

이 외에도 많다.

### 시계열을 모델링하고 예측하는 많은 방법들이 있다.
**기법:** 시계열 모델을 맞추는 것은 힘들지만 중요하면서 도전적인 일이라고 할 수 있다. 다음에 소개할 기법을 포함하여 모델을 맞추는 다양한 방법이 있다.
  * 박스-젠킨스 ARIMA 모델
  * 박스-젠킨스 다변량 모델
  * 홀트-윈터스(Holt-Winters) 지수 평활법(단일, 이중, 삼중)

이 글에서는 적절한 기법을 선택하는 것까지 다루지는 않는다. 다음과 같은 기본적인 평활법을 다루면서 본격적인 설명을 시작한다.
  * 평균법
  * 지수 평활법

이 절의 뒷 부분에서 박스-젠킨스 모델링 방법과 다변량 시계열을 다룰 것이다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc41.htm


## 6.4.2. 이동 평균과 평활법이란?
### 데이터 평활은 무작위적인 변화를 줄이고 추세와 주기적인 요소를 보여준다
시간에 따라 수집한 데이터에는 무작위적인 변화량이 있다. 무작위적인 변화로 생기는 효과를 줄이기 위한 방법들이 있다. 산업에서 흔히 사용하는 기법은 "평활"이다. 이 방법을 제대로 사용하면 추세, 계절성, 주기성과 관련된 구성 요소를 더욱 분명하게 확인할 수 있다.

두 가지 평활법이 있다.
  * 평균법
  * 지수 평활법


### 평균을 계산하는 것은 가장 단순한 평활법이다.
먼저, 모든 과거 데이터의 단순 평균을 계산하는 방법 같은 몇 가지 평균법을 살펴보자.

어떤 창고를 운영하는 사람이 공급자가 얼마나 많이 배달하는지 1000 달러 단위로 알고 싶어하는 경우를 생각해보자. 운영자는  무작위로 12명을 선택하여 다음과 같은 결과를 얻었다.

| 공급자 | 공급량 | 공급자 | 공급량 |
|--------|--------|--------|--------|
| 1      | 9      | 7      | 11     |
| 2      | 8      | 8      | 7      |
| 3      | 9      | 9      | 13     |
| 4      | 12     | 10     | 9      |
| 5      | 9      | 11     | 11     |
| 6      | 12     | 12     | 10     |

평균값은 10이다. 운영자는 이 값을 표본을 대표하는 공급자의 비용으로 사용하기로 결정했다.

과연 잘 추정한 것일까?


### 평균 제곱 오차는 모델이 얼마나 좋은지 판단하는 한 가지 방법이다
평균 제곱 오차를 계산해보자.
  * "오차" = 정말로 소비한 양 - 추정한 양.
  * "제곱 오차"는 위의 오차를 제곱한 값.
  * SSE는 제곱 오차의 합.
  * MSE는 제곱 오차의 평균.


### 위의 예에서 MSE 결과
결과는 다음과 같다.

오차와 제곱 오차의 경우 
추정치 = 10

| 공급자 | $  | 오차 | 제곱 오차 |
|--------|----|------|-----------|
| 1      | 9  | -1   | 1         |
| 2      | 8  | -2   | 4         |
| 3      | 9  | -1   | 1         |
| 4      | 12 |  2   | 4         |
| 5      | 9  | -1   | 1         |
| 6      | 12 |  2   | 4         |
| 7      | 11 |  1   | 1         |
| 8      | 7  | -3   | 9         |
| 9      | 13 |  3   | 9         |
| 10     | 9  | -1   | 1         |
| 11     | 11 |  1   | 1         |
| 12     | 10 |  0   | 0         |

SSE = 36 그리고 MSE = 36/12 = 3


### 다른 추정값을 사용한 MSE 결과표
각 공급자에 대한 소비량 추정치가 얼마나 좋은가? 10을 7, 9, 12와 비교해보자.

| 지표 |  7  |  9  |  10  |  12  |
|------|-----|-----|------|------|
| SSE  | 144 | 48  | 36   | 84   |
| MSE  |  12 |  4  |  3   |  7   |

가장 작은 MSE를 보이는 추정치가 가장 좋은 것이다. 위의 표는 무작위 데이터에서 추정치에 대한 MSE를 최소화하는 것이 평균임을 수학적으로 보여준다.


### 표본 데이터의 평균에 대한 제곱 오차를 보여주는 표
평균이 시간에 따른 순이익을 얼마나 잘 예측하는지 살펴보자.

다음은 1985년부터 1994년까지 어떤 컴퓨터 제조사의 세전 수입을 나타내는 표이다.

| 연도 | $ (백만)   | 평균    | 오차   | 제곱 오차     |
|------|------------|---------|--------|---------------|
| 1985 | 46.163     | 48.676  | -2.513 | 6.313         |
| 1986 | 46.998     | 48.676  | -1.678 | 2.814         |
| 1987 | 47.816     | 48.676  | -0.860 | 0.739         |
| 1988 | 48.311     | 48.676  | -0.365 | 0.133         |
| 1989 | 48.758     | 48.676  | 0.082  | 0.007         |
| 1990 | 49.164     | 48.676  | 0.488  | 0.239         |
| 1991 | 49.548     | 48.676  | 0.872  | 0.761         |
| 1992 | 48.915     | 48.676  | 0.239  | 0.057         |
| 1993 | 50.315     | 48.676  | 1.639  | 2.688         |
| 1994 | 50.768     | 48.676  | 2.092  | 4.378         |

MSE = 1.8129


### 추세가 있을 때 평균은 좋은 지표가 아니다
추세가 있을 것 같을 때, 수입을 예측할 때 평균을 사용할 수 있을까? 아래의 그래프에서 보면, 사용하면 안 된다는 것을 알 수 있다.

![](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/tseries1.gif)
* 가로축은 연도, 세로축은 수입


### 평균은 모든 과거 관측값을 동일한 가중치로 다룬다
요약하면, 
  1. 단순 평균이나 모든 과거 관측값의 평균은 추세가 없을 때만 쓸모 있다. 추세가 있으면, 추세를 고려하는 다른 측정량을 사용하자.
  2. 평균은 모든 과거 관측값을 동일하게 다룬다. 예를 들면, 3, 4, 5의 평균값은 4이다. 물론, 우리는 모든 값을 더해서 값의 갯수로 나눠서 평균을 구한다는 것을 알고 있다. 아래와 같이 각 값을 값의 갯수로 나눈 값을 더해서 평균을 구할 수도 있다.

  3/3 + 4/3 + 5/3 = 1 + 1.3333 + 1.6667 = 4.
  
곱하는 수 1/3을 가중치라고 한다. 일반적으로

1/n 은 가중치이고 모두 더하면 1이다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc42.htm


## 6.4.2.1. 단일 이동 평균
### 이동 평균은 평활하는 과정이다
과거 데이터 중에서 전부가 아닌 일부의 평균을 다음과 같이 계산하여 과거 데이터를 요약할 수도 있다.

> 무작위로 뽑은 12명의 공급자 예제에서 사용한 데이터를 다시 떠올려보자. 9, 8, 9, 12, 9, 12, 11, 7, 13, 9, 11, 10. 크기가 3인 집합 M이 있다고 하자. 이 때 처음부터 3번째 값까지의 평균은 (9 + 8 + 9) / 3 = 8.667이다.

이것을 "평활"이라고 한다. 평활은 한 구간에서 시작해서 첫 번째 값을 제외한 그 다음 3개의 값의 평균을 계산하는 방식으로 진행한다.


### 이동 평균 예제
다음의 표는 이동 평균이라고 불리는 평활 과정을 나타낸다. 이동 평균은 일반적으로 다음과 같이 쓸 수 있다.
M_t = \frac{ X_{t} + X_{t-1} + \cdots + X_{t-N+1} }{N}

이동 평균 결과

| 공급자 | $  | 이동 평균 | 오차    | 제곱 오차 |
|--------|----|-----------|---------|-----------|
| 1      | 9  |           |         |           |
| 2      | 8  |           |         |           |
| 3      | 9  |  8.667    |  0.333  |  0.111    |
| 4      | 12 |  9.667    |  2.333  |  5.444    |
| 5      | 9  | 10.000    | -1.000  |  1.000    |
| 6      | 12 | 11.000    |  1.000  |  1.000    |
| 7      | 11 | 10.667    |  0.333  |  0.111    |
| 8      | 7  | 10.000    | -3.000  |  9.000    |
| 9      | 13 | 10.333    |  2.667  |  7.111    |
| 10     | 9  |  9.667    | -0.667  |  0.444    |
| 11     | 11 | 11.000    |  0      |  0        |
| 12     | 10 | 10.000    |  0      |  0        |

이전의 보통 평균에서 MSE는 3이었지만 이 경우는 MSE = 2.42 이다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc421.htm


## 6.4.2.2. 중앙 이동 평균
### 이동 평균을 계산할 때, 평균을 중간 시기에 놓는 것이 이치에 맞는다
이전 예제에서 처음 3개 시기의 평균을 계산하여, 3번째 숫자 다음에 계산한 값을 두었다. 평균값을 계산했던 구간의 중앙에 놓을 수도 있었다. 즉, 2번째 숫자 다음에 놓을 수도 있었다는 말이다. 이러한 방법은 홀수개의 숫자가 있을 때는 사용해도 괜찮지만, 짝수개의 숫자가 있을 때는 사용하기 곤란하다. 그렇다면 M = 4일 때, 첫 번째 이동 평균값을 어디에 두어야 할까?
  * M = 이동 평균 계산하는 숫자의 갯수

엄밀하게 따지면, 이동 평균은 t = 2.5, 3.5, ... 같은 곳에 놓일 것이다.

이런 경우를 피하기 위해, M = 2일 때 이동 평균을 평활하자. 평활한 값을 평활하자는 이야기이다!


### 짝수개의 숫자의 평균을 구한다면 평활한 값을 다시 평활해야 한다
다음의 표는 M = 4일 때, 결과를 나타낸다.

중간 과정

| 시점 | 값 | 이동 평균 | 중앙   |
|------|----|-----------|--------|
| 1    |  9 |           |        |
| 1.5  |    |           |        |
| 2    |  8 |           |        |
| 2.5  |    |  9.5      |        |
| 3    |  9 |           |  9.5   |
| 3.5  |    |  9.5      |        |
| 4    | 12 |           | 10.0   |
| 4.5  |    | 10.5      |        |
| 5    |  9 |           | 10.750 |
| 5.5  |    | 11.0      |        |
| 6    | 12 |           |        |
| 6.5  |    |           |        |
| 7    | 11 |           |        |


### 결과 표
최종 결과 표이다.

| 시점 | 값 | 중앙 이동 평균 |
|------|----|----------------|
| 1    |  9 |                |
| 2    |  8 |                |
| 3    |  9 |          9.5   |
| 4    | 12 |         10.0   |
| 5    |  9 |         10.750 |
| 6    | 12 |                |
| 7    | 11 |                |

### 예측할 때 이동 평균으로 의미있는 추세를 다룰 수 없다
안타깝게도 전체 데이터의 평균이나 가장 최근 M개 값의 이동 평균이나 둘 모두, 다음 시기를 예측하려 할 때, 의미있는 추세를 다룰 수 없다.

#### 선형 추세에 대한 이중 이동 평균
이동 평균을 변형시켜 추세를 좀 더 잘 다루는 방법이 있다. 이 방법은 선형 추세에 대한 이중 이동 평균이라고 알려져 있다. 같은 M 값으로 원래 이동 평균의 이동 평균을 구하고(두 번째 이동 평균), 구한 두 종류의 이동 평균 값을 가지고 기울기와 y절편을 구한다. 그 다음 한 개 이상의 시기를 예측한다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc422.htm


## 6.4.3. 지수 평활법이란?
### 지수 평활법은 과거 관측값을 지수적으로 감소하는 가중치로 다룬다
이 방법은 평활한 시계열을 구할 때 사람들이 정말 많이 사용하는 방법이다. 단일 이동 평균은 과거 관측값을 동일한 가중치로 다루지만, 지수 평활법은 관측값이 오래된 것일 수록 지수적으로 감소하는 가중치로 다룬다.

다시 말해, 예측할 때 최근 관측값에는 오래된 관측값보다 상대적으로 더 높은 가중치가 붙는다는 것이다.

이동 평균은 관측값을 정확하게 같은 가중치 1/N로 다룬다. 하지만, 지수 평활법에서는 정하거나 계산해서 넣어줘야 할 1개 이상의 평활 매개변수가 있다. 이러한 매개변수에 따라 가중치 값이 변한다.

이번 절에서는 단일, 이중, 삼중 지수 평활법을 살펴보자.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc43.htm


## 6.4.3.1. 단일 지수 평활법
### 지수 평활법은 미래 값을 예측하기 위해 과거 관측값을 지수적으로 감소하는 가중치로 다룬다
이 평활법은 S_2 를 y_1로 두는 것부터 시작한다. S_i는 평활화한 관측이나 EWMA (Exponentially Weighted Moving Average)를, y는 원래의 관측값을 나타낸다. 아래 첨자는 시기를 의미한다(1, 2, ..., n). 3번째 시기에 대해 다음과 같이 쓸 수 있다. S_{3} = \alpha y_{2} + (1-\alpha)S_{2}. 다른 시기에 대해서도 마찬가지로 쓸 수 있지만, S_{1} 값은 없다.

어떤 시기 t에 대해, 평활화한 값 S_i 는 다음과 같이 계산할 수 있다.

S_t = \alpha y_{t-1} + (1-\alpha)S_{t-1}
0 < \alpha <= 1
t >= 3

이것이 지수 평활법의 기본 등식이고, 상수 또는 매개변수 \alpha 를 평활 상수라고 한다.

**Note:** 기본 등식에서 y_{t-1}을 y_{t}로 바꾼 방법도 있다. Robert가 1959년에 제안한 이 방법은 EWMA 제어 차트 절에 서술하였다. 여기에서 사용하는 등식은 1986년에 Hunter가 제안한 것을 따른다.


### 첫 번째 예측이 아주 중요하다
#### 첫 번째 EWMA 정하기
첫 번째 EWMA는 다음에 나오는 모든 EWMA 값을 계산하는데 중요한 역할을 한다. S_2를 y_1로 정하는 것은 일종의 초기화이다. 다른 방법으로 정할 수도 있다.

처음 4개나 5개의 관측값을 평균할 것인지도 정할 수 있다.

\alpha 값이 작을 수록 처음 EWMA를 정하는 것이 중요하게 된다. 초기 설정을 확정하기 전에 몇 가지 방법들을 시도해보길 바란다(여기에서는 사용하는 소프트웨어가 이러한 기능을 지원하고 있다는 것을 가정하고 있다).


### 기본 등식을 전개하기
#### 왜 "지수"라는 말이 들어가는가?
먼저 S_{t-1}를 기본 등식에 대입해서 전개하면 다음과 같은 식을 얻을 수 있다.
S_{t} = \alpha y_{t-1} + (1-\alpha)\left[ \alpha y_{t-2} + (1-\alpha)S_{t-2} \right]
= \alpha y_{t-1} + \alpha(1-\alpha) y_{t-2} + (1-\alpha)^{2}S_{t-2}


### 기본 등식에 관한 합 공식
S_{2}가 나올 때까지 S_{t-2}, S_{t-3}, ... 이런 식으로 대입하면 다음과 같은 전개식을 쓸 수 있다.
S_{t} = \alpha \sum_{i=1}^{t-2} (1-\alpha)^{i-1} y_{t-i} + (1-\alpha)^{t-2} S_{2}, t >= 2


### S_5에 대하여 전개한 등식
예를 들면, S_5에 대해 전개한 식은
S_{5} = \alpha \left[ (1-\alpha)^{0} y_{5-1} + (1-\alpha)^{1} y_{5-2} + (1-\alpha)^{2} y_{5-3} \right] + (1-\alpha)^{3} S_{2}


### 지수적인 성질을 보인다
이 식은 지수적인 성질을 보인다. 가중치 \alpha(1-\alpha)^{t} 는 기하적으로 감수하며, 기하 급수의 성질을 이용하면 다음과 같이 합은 1이다.

\alpha \sum_{i=0}^{t-1} (1-\alpha)^{i} = \alpha \left[ \frac{ 1 - (1-\alpha)^{t} }{ 1 - (1-\alpha) } \right] = 1 - (1-\alpha)^{t}

위의 식에서 보면, t가 증가할 수록 평활화한 S_t의 영향이 점점 작아지는 것을 알 수 있다.


### \alpha=0.3 일 때 예제
\alpha=0.3인 경우, 가중치 \alpha(1-\alpha)^{t}는 시간에 따라 지수적으로(기하적으로) 감소한다.

| 값  | 가중치 |
|-----|--------|
| y_1 | 0.2100 |
| y_2 | 0.1470 |
| y_3 | 0.1029 |
| y_4 | 0.0720 |


### 가중치 매개변수를 어떻게 선택할 것인가?
#### 어떤 \alpha가 "가장" 좋은 값인가?
오래된 값을 평활화하는 빠르기는 \alpha값의 함수이다. \alpha가 1에 가까우면 빠르게 평활화가 일어나고, 0에 가까우면 느리게 일어난다. 다음의 표는 이와 같은 과정을 보여준다.

 과거의 관측값 방향
 → → → → → → →

| \alpha | (1-\alpha) | (1-\alpha)^{2} | (1-\alpha)^{3} | (1-\alpha)^{4} |
|--------|------------|----------------|----------------|----------------|
| 0.9    | 0.1        | 0.01           | 0.001          | 0.0001         |
| 0.5    | 0.5        | 0.25           | 0.125          | 0.0625         |
| 0.1    | 0.9        | 0.81           | 0.729          | 0.6561         |

가장 작은 MSE를 얻을 수 있는 \alpha 값이 가장 좋은 값이다.


### 예제
한 예제로 이 원리를 살펴보자. 다음과 같이 시간에 따른 12개의 관측값이 있는 상황을 생각해보자.

| 시점 | y_t | S(\alpha=0.1) | 오차  | 제곱 오차 |
|------|-----|---------------|-------|-----------|
|  1   | 71  |               |       |           |
|  2   | 70  | 71            | -1.00 |  1.00     |
|  3   | 69  | 70.9          | -1.90 |  3.61     |
|  4   | 68  | 70.71         | -2.71 |  7.34     |
|  5   | 64  | 70.44         | -6.44 | 41.47     |
|  6   | 65  | 69.80         | -4.80 | 23.04     |
|  7   | 72  | 69.32         |  2.68 |  7.18     |
|  8   | 78  | 69.58         |  8.42 | 70.90     |
|  9   | 75  | 70.43         |  4.57 | 20.88     |
| 10   | 75  | 70.88         |  4.12 | 16.97     |
| 11   | 75  | 71.29         |  3.71 | 13.76     |
| 12   | 70  | 71.67         | -1.67 |  2.79     |

제곱 오차의 합(SSE)은 208.94이고, 제곱 오차의 평균(MSE)은 SSE / 11 = 19.0 이다.


### 다른 \alpha 값에 대해 계산하기
\alpha=0.5 인 경우에 MSE를 계산하면 16.29를 얻을 수 있다. 더 좋은 값을 얻을 수 있을까? 시행착오(trial-and-error) 접근법을 적용해볼 수 있다. \alpha를 0.1부터 0.9까지 탐색하고 그 중에서 가장 좋은 \alpha를 선택한 다음, \alpha-\Delta와 \alpha+\Delta 범위에서 작업을 반복한다. 한 번 더 반복하면, 소수점 3째 자리 정확도를 가지는 \alpha를 찾을 수 있다.


### 비선형 최적화를 사용할 수 있다
하지만 마르쿼트(Marquardt) 방법 같은 더 좋은 탐색법이 있다. 이 방법은 실제 값과 추정 값의 차이(residual) 제곱 합을 최소화하는 비선형 최적화 기법이다. 일반적으로 보통 잘 설계한 통계 프로그램들은 MSE를 최소화하는 \alpha를 찾아야만 한다.


### 2개의 \alpha 에 대해 평활화한 데이터를 보여주는 그래프

![](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/tseries2.gif)


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc431.htm


## 6.4.3.2. 단일 지수 평활법을 이용한 예측
### 다음 값을 예측하기
#### 예측 식
예측 식은 기본 등식이다.
S_{t+1} = \alpha y_{t} + (1 - \alpha)S_{t}, 0< \alpha <= 1, t>0.


### 새로운 예측은 이전 예측에 오차 수정치를 더한 것이다
위의 식은 다음과 같이 쓸 수 있다.
S_{t+1} = S_{t} + \alpha \epsilon_{t}
여기에서 \epsilon_{t}는 시기 t의 예측 오차(실제 - 예측)이다.

다시 말해, 새로운 예측은 이전 예측에 가장 마지막 예측의 오차 수정치를 더한 것이다.


### 재복합 예측(Bootstrapping forecasts)
#### 예측의 재복합
실제 관측값이 없는데 어떤 시점(보통 가장 마지막 시점)에서 예측하고 싶다면 어떻게 될까? 이러한 상황에서는 위의 예측 식을 다음과 같이 바꿔야한다.
S_{t+1} = \alpha y_{origin} + (1-\alpha)S_{t}
여기에서 y_{origin}은 상수이다. 이 기법을 재복합이라고 부른다.


### 예
#### 재복합의 예
이전 예제에서 마지막 시점은 70이었고, 예측값(평활화된 값 S)은 71.7이었다. 데이터 값과 예측치를 가지고 있기 때문에, 이전에 사용했던 보통의 등식(재복합 아닌)을 가지고 \alpha=0.1인 경우에 그 다음 시점을 예측할 수 있다.
S_{t+1} = \alpha y_{origin} + (1-\alpha)S_{t}
= 0.1(70) + 0.9(71.7)
= 71.5

하지만 그 다음 시점은 관측 값이 없기 때문에 다음과 같이 계산하자.
S_{t+2} = 0.1(70) + 0.9(71.5) = 71.35


### 두 방법을 비교하는 표
#### 재복합 예측과 보통 예측 비교
다음의 표는 두 방법을 대조하여 보여준다.

| 시점 | 재복합 예측 | 데이터 | 단일 평활 예측 |
|------|-------------|--------|----------------|
| 13   | 71.50       | 75     | 71.5           |
| 14   | 71.35       | 75     | 71.9           |
| 15   | 71.21       | 74     | 72.2           |
| 16   | 71.09       | 78     | 72.4           |
| 17   | 70.98       | 86     | 73.0           |

#### 추세를 고려하는 단일 지수 평활
단일 평활(단일 지수 평활을 줄여서)은 추세가 있을 때 그리 좋은 선택은 아니다. 단일 계수 \alpha로만 부족하다.


### 추세가 있는 표본 데이터
\alpha=0.3 로 평활화한 다음 데이터를 살펴보자.

| 데이터 | 맞춤 |
|--------|------|
|  6.4   |      |
|  5.6   |  6.4 |
|  7.8   |  6.2 |
|  8.8   |  6.7 |
| 11.0   |  7.3 |
| 11.6   |  8.4 |
| 16.7   |  9.4 |
| 15.3   | 11.6 |
| 21.6   | 12.7 |
| 22.4   | 15.4 |


### 추세가 있을 때 단일 평활법이 적절하지 않다는 것을 보여주는 그래프
결과 그래프는 다음과 같다.

![](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/tseries3.gif)


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc432.htm


## 6.4.3.3. 이중 지수 평활법
### 이중 지수 평활법에는 두 개의 상수 매개변수가 있고, 이 방법은 추세를 다루기에 좀 더 적합하다
바로 이전에 본 것처럼, 단일 평활법은 추세가 있는 경우를 다루기에 좋지 않다. 기본 등식과 함께 \gamma라는 상수를 포함하는 한 가지 식을 더 고려하면 단일 평활법을 개선할 수 있다. \gamma는 반드시 \alpha와 함께 사용해야 한다.

아래는 이중 지수 평활법을 나타내는 두 식이다.
S_{t} = \alpha y_{t} + (1-\alpha)( S_{t-1} + b_{t-1} )  0 <= \alpha <= 1
b_{t} = \gamma ( S_{t} - S_{t-1} ) + (1-\gamma)b_{t-1}  0 <= \gamma <= 1

이중 지수 평활법에서 시계열의 현재 값은 평활화한 현재 값을 계산하는데 사용된다.


### 초기값을 선택하는 몇 가지 방법
#### 초기값
단일 평활법 경우처럼 이중 평활법에서 S_{t}와 b_{t} 식의 초기값을 여러 가지 방법으로 정할 수 있다.

일반적으로 S_{1}은 y_{1}로 정한다. 아래 3가지 방법 중에서 b_{1} 을 정하면 좋다.

b_{1} = y_{2} - y_{1}
b_{1} = \frac{1}{3} \left[ (y_{2} - y_{1} ) + ( y_{3} - y_{2} ) + (y_{4} - y_{3}) \right]
b_{1} = \frac{ y_{n} - y_{1} }{ n - 1 }

### 평활식의 의미
#### 첨언
첫 번째 평활식은 이전 시점의 추세 b_{t-1}를 이전 평활값에 더하여 이전 시점의 추세에 대해 S_{t} 를 맞춘다. 이 과정은 뒤처짐을 제거하고 S_{t}을 현재값에 적절하게 맞춘다.

두 번째 평활식은 마지막 두 값의 차이를 나타내는 추세를 갱신한다. 이 식은 단일 평활의 기본 등식과 비슷하지만, 추세를 갱신하는 부분이 다르다.


### 비선형 최적화 기법을 사용할 수 있다
\alpha와 \gamma 값을 마르쿼트(Marquardt) 알고리즘 같은 비선형 최적화 기법을 사용해서 구할 수 있다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc433.htm


## 6.4.3.4. 이중 지수 평활법을 이용한 예측(LASP)
### 예측식
한 시점 앞을 예측하는 식은 다음과 같이 쓸 수 있다.

F_{t+1} = S_{t} + b_{t}

m 시점 앞을 예측하는 식은 다음과 같이 쓸 수 있다.

F_{t+m} = S_{t} + m b_{t}


### 예제
다음의 데이터를 다시 한 번 살펴보자.
  6.4, 5.6, 7.8, 8.8, 11, 11.6, 16.7, 15.3, 21.6, 22.4.
\alpha=0.3623과 \gamma=1.0인 이중 평활법 모델로 맞춰보자. 이 두 매개변수는 원본 시게열을 한 시점 앞 예측과 비교하여 최소 MSE값과 가까운 것이다(지금 다루는 이중 지수 평활법은 평활값을 계산하기 위해 현재 시계열 값을 사용한다). 초기값은 다음과 같다.
S_{1} = y_{1} = 6.4
b_{1} = \frac{1}{3} \left[ (y_{2} - y_{1}) + (y_{3} - y_{2}) + (y_{4} - y_{3}) \right]

대조군으로 \alpha=0.977일 때의 단일 평활 모델도 해보자. 이 \alpha 값은 단일 지수 평활법에서 최소 MSE와 가까운 값이다.


### 예제 결과 예측
예제에서 평활 결과는 다음과 같다.

| 데이터 | 이중               | 단일  |
|--------|--------------------|-------|
|  6.4   |  6.4               |       |
|  5.6   |  6.6 (예측 =  7.2) |  6.4  |
|  7.8   |  7.2 (예측 =  6.8) |  5.6  |
|  8.8   |  8.1 (예측 =  7.8) |  7.8  |
| 11.0   |  9.8 (예측 =  9.1) |  8.8  |
| 11.6   | 11.5 (예측 = 11.4) | 10.9  |
| 16.7   | 14.5 (예측 = 13.2) | 11.6  |
| 15.3   | 16.7 (예측 = 17.4) | 16.6  |
| 21.6   | 19.9 (예측 = 18.9) | 15.3  |
| 22.4   | 22.8 (예측 = 23.1) | 21.5  |

### 표는 단일 및 이중 지수 평활법으로 예측한 결과를 나타낸다
#### 예측값 비교
각 방법이 미래를 어떻게 예측했는지 살펴보기 위해, 가장 마지막 관측값 이후 5개 시점을 계산하면,

| 시점 | 단일 | 이중 |
|------|------|------|
| 11   | 22.4 | 25.8 |
| 12   | 22.4 | 28.7 |
| 13   | 22.4 | 31.7 |
| 14   | 22.4 | 34.6 |
| 15   | 22.4 | 37.6 |


### 단일 및 이중 지수 평활법으로 예측한 결과를 비교하는 그래프
결과를 나타내는 그래프로 보면 아주 명확하게 차이를 볼 수 있다.

![](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/tseries4.gif)

이 그래프는 이중 평활법이 단일 평활법보다 데이터에 훨씬 더 가깝다. 단일 평활법은 예측할 때 단순하게 수평선과 다를바가 없다는 것도 알 수 있다. 실제 상황에서 이런 수평선과 같은 상황이 일어날 가능성은 낮다. 따라서 이 경우에는 이중 평활법이 낫다.


### 이중 지수 평활법과 회귀법으로 예측한 결과를 비교하는 그래프
선형 회귀법과 이중 지수 평활법을 비교해보자.

![](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/tseries5.gif)

꽤 재미있는 그림이다. 두 기법 모두 비슷한 경향을 따르지만, 회귀선은 이중 평활법에 비해 예측값이 느리게 증가한다.


### 예측하는 사람마다 다른 기법을 선택한다
예측하는 사람에 따라 선택하는 기법이 다르다. 성장과정을 공격적으로 나타내고 싶으면, 이중 평활법을 선택한다. 아니면, 회귀법을 사용할 것이다. 선형 회귀법에서 "시간"은 독립 변수 역할을 한다. 4장에서 선형 회귀의 기본적인 내용과 회귀 추정의 세부 사항을 이야기했다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc434.htm


## 6.4.3.5. 삼중 지수 평활법
만약에 데이터에 추세와 계절성이 있다면 어떻게 해야할까?

### 계절성을 다루기 위해 3번째 매개변수를 추가해야 한다
이런 경우에는 이중 평활법이 적합하지 않다. 계절성(때때로 주기성이라고도 부르는)을 다루기 위해 3번째 식을 도입하자. 이를 제안한 사람의 이름을 따라 "홀트-윈터스"(Holt-Winters, 약자로 HW)로 부른다.

이 경우에 기본 등식은 다음과 같다.
S_{t} = \alpha \frac{ y_{t} }{ I_{t-L} } + (1-\alpha)(S_{t-1} + b_{t-1})  전체적인 평활
b_{t} = \gamma (S_{t} - S_{t-1}) + (1 - \gamma)b_{t-1}  추세 평활
I_{t} = \beta \frac{ y_{t} }{ S_{t} } + (1 - \beta) I_{t-L}  계절성 평활
F_{t+m} = (S_{t} + m b_{t}) I_{t - L + m}  예측

여기에서
  * y는 관측값
  * S는 평활화한 관측값
  * b는 추세 인자
  * I는 계절성 지표
  * F는 m 시점 앞 예측
  * t는 어떤 시간 주기를 나타내는 지표

그리고 \alpha, \beta, \gamma는 오차의 MSE를 최소화하여 구할 수 있는 상수이다. 이 작업은 좋은 소프트웨어 패키지의 몫이다.


### 완벽한 계절 정보가 필요하다
HW 방법을 초기화하려면 적어도 하나의 완벽한 계절 데이터가 필요하다. 계절성 지표 초기값 I_{t-L}을 추정하기 위해서이다.


### 한 계절에 L 주기
어떤 하나의 계절 데이터는 L 주기로 구성된다. 그리고 한 주기에서 다음 주기까지의 추세 인자를 추정해야 한다. 그러기 위해서는 두 계절이 있는 데이터(즉, 2L 주기가 있는) 사용하기를 권한다.


### 추세와 계절성 매개변수를 어떻게 초기화 할 것인가
#### 초기값 추세 인자
초기 추세를 계산하는 일반적인 식은 다음과 같다.
b = \frac{1}{L} \left( \frac{y_{L+1} - y_{1}}{L} + \frac{y_{L+2}-y_{2}}{L} + \cdots + \frac{y_{L+L} - y_{L}}{L} \right)

#### 계절성 지수의 초기값
1년에 4 주기가 있는 6년치 데이터를 살펴보자.

### Step 1: 연도 평균
**Step 1:** 각 연도마다 주기의 평균을 구한다.
A_{p} = \frac{ \sum_{i=1}^{4} y_{i} }{ 4 },  p = 1, 2, ..., 6.

### Step 2: 연도 평균으로 나눈다
**Step 2:** 관측값을 적절한 연도 평균으로 나눈다.

| 1번째 연도  | 2번째 연도  | 3번째 연도    | 4번째 연도   | 5번째 연도   | 6번째 연도   |
|-------------|-------------|---------------|--------------|--------------|--------------|
| y_{1}/A_{1} | y_{5}/A_{2} | y_{9}/A_{3}   | y_{13}/A_{4} | y_{17}/A_{5} | y_{21}/A_{6} |
| y_{2}/A_{1} | y_{6}/A_{2} | y_{10}/A_{3}  | y_{14}/A_{4} | y_{18}/A_{5} | y_{22}/A_{6} |
| y_{3}/A_{1} | y_{7}/A_{2} | y_{11}/A_{3}  | y_{15}/A_{4} | y_{19}/A_{5} | y_{23}/A_{6} |
| y_{4}/A_{1} | y_{8}/A_{2} | y_{12}/A_{3}  | y_{16}/A_{4} | y_{20}/A_{5} | y_{24}/A_{7} |

### Step 3: 계절성 지표를 구성한다
**Step 3:** 각 행의 평균을 계산해서 계절성 지표를 구성한다. 그러면 초기 계절성 지수는 (상징적인 의미에서) 다음과 같다.
I_{1} = \left( y_{1}/A_{1} + y_{5}/A_{2} + y_{9}/A_{3}  + y_{13}/A_{4} + y_{17}/A_{5} + y_{21}/A_{6} \right) / 6
I_{2} = \left( y_{2}/A_{1} + y_{6}/A_{2} + y_{10}/A_{3} + y_{14}/A_{4} + y_{18}/A_{5} + y_{22}/A_{6} \right) / 6
I_{3} = \left( y_{3}/A_{1} + y_{7}/A_{2} + y_{11}/A_{3} + y_{15}/A_{4} + y_{19}/A_{5} + y_{23}/A_{6} \right) / 6
I_{4} = \left( y_{4}/A_{1} + y_{8}/A_{2} + y_{12}/A_{3} + y_{16}/A_{4} + y_{20}/A_{5} + y_{24}/A_{6} \right) / 6

지금까지 계절성 지수를 어떻게 초기화하는지 살펴보았다.

다음 내용에서는 삼중 지수 평활법을 적용하는 예제를 다룰 것이다.

### 추세와 계절성 매개변수 계수가 0인 경우
#### 계수가 0인 경우
삼중 지수 평활법을 컴퓨터로 계산하면 가끔 \gamma나 \beta가 0인 경우나 둘 다 0인 경우가 있다.

이러한 경우에 추세나 계절성이 없다고 봐야할까?

당연히 아니다! 추세나 계절성 관련 초기값이 MSE가 최소일 수 있는 경우라 갱신할 필요 없어서 그렇다. 정말로 그런지 검증하기 위해 갱신하는 식을 반드시 점검해야 한다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc435.htm


## 6.4.3.6. 삼중 지수 평활법 예제
### 단일, 이중, 삼중 지수 평활법을 비교하는 예
이 예제에 있는 데이터를 통해 단일, 이중, 삼중 지수 평활법을 비교해보자.

다음 데이터에는 24개 관측값이 있다. 6년에 걸친 분기별 데이터이다(1년에 4개의 분기가 있다).

| 연도 | 분기 | 시점 | 판매량 |
|------|------|------|--------|
| 90   | 1    |  1   | 362    |
|      | 2    |  2   | 385    |
|      | 3    |  3   | 432    |
|      | 4    |  4   | 341    |
| 91   | 1    |  5   | 382    |
|      | 2    |  6   | 409    |
|      | 3    |  7   | 498    |
|      | 4    |  8   | 387    |
| 92   | 1    |  9   | 473    |
|      | 2    | 10   | 513    |
|      | 3    | 11   | 582    |
|      | 4    | 12   | 474    |
| 93   | 1    | 13   | 544    |
|      | 2    | 14   | 582    |
|      | 3    | 15   | 681    |
|      | 4    | 16   | 557    |
| 94   | 1    | 17   | 628    |
|      | 2    | 18   | 707    |
|      | 3    | 19   | 773    |
|      | 4    | 20   | 592    |
| 95   | 1    | 21   | 627    |
|      | 2    | 22   | 725    |
|      | 3    | 23   | 854    |
|      | 4    | 24   | 661    |

### 단일, 이중, 삼중 지수 평활법으로 가공하지 않은 데이터를 예측한 결과 그래프
![](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/tseries6.gif)


### 삼중 지수 평활법으로 가공하지 않은 데이터를 예측한 결과 그래프
![](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/tseries7.gif)

### MSE 비교
| MSE  | 수요   | 추세   | 계절성 |
|------|--------|--------|--------|
| 6906 | 0.4694 |        |        |
| 5054 | 0.1086 | 1.0000 |        |
|  936 | 1.0000 |        | 1.0000 |
|  520 | 0.7556 | 0.0000 | 0.9837 |

위의 계수는 각 기법마다 MSE를 최소화하는 프로그램으로 구한 것이다.


### 초기 추세 계산
#### 초기 추세 계산 예제
데이터는 분기별 판매량 값으로 구성되어있다. 1년에 4개의 분기가 있기 때문에(L = 4) 계절은 1년이다. 위에서 구한 식을 사용하면,

b_{1} = \frac{1}{4} \left[ \frac_{ y_{5}-y_{1} }{4} + \frac_{ y_{6}-y_{2} }{4} + \frac_{ y_{7}-y_{3} }{4} + \frac_{ y_{8}-y_{4} }{4} \right]
= \frac{1}{4} \left[ \frac_{ 382-362 }{4} + \frac_{ 409-385 }{4} + \frac_{ 498-432 }{4} + \frac_{ 387-341 }{4} \right]
= \frac{5 + 6 + 16.5 + 11.5}{4} = 9.75

### 초기 계절성 지표에 관한 표
#### 초기 계절성 지표를 계산하는 예
| 분기 | 1번째 연도 | 2번째 연도 | 3번째 연도 | 4번째 연도 | 5번째 연도 | 6번째 연도 |
|------|------------|------------|------------|------------|------------|------------|
| 1    | 362        | 382        | 473        | 544        | 628        | 627        |
| 2    | 385        | 409        | 513        | 582        | 707        | 725        |
| 3    | 432        | 498        | 582        | 681        | 773        | 854        |
| 4    | 341        | 387        | 474        | 557        | 592        | 661        |
| X    | 380        | 419        | 510.5      | 591        | 675        | 716.75     |

이 예제에서 6년의 데이터를 사용했다. 다른 방법으로 하면 3이나 다른 값이 될 수도 있다. 초기값은 다양한 방법으로 계산할 수 있다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc436.htm


## 6.4.3.7. 지수 평활법 요약
### 지수 평활법은 유용하다고 입증된 방법이다
#### 요약
지수 평활법은 많은 시간에 걸쳐 예측이 필요한 많은 경우에 있어서 아주 유용하다고 입증된 방법이다. 1957년 C. C. 홀트(Holt)가 계절성과 추세가 없는 시계열에 사용하려고 처음 고안하였다. 이후 홀트는 1958년에 추세를 다루는 방법을 제시하였다. 1965년 윈터스(Winters)가 이 방법에 계절성을 넣어 일반화하여 "홀트-윈터스 기법"이라는 이름이 붙었다.

### 홀트-윈터스는 3개의 갱신하는 식으로 구성된다
홀트-윈터스 기법은 3개의 갱신하는 식으로 구성된다. 각각에는 0과 1 사이의 상수가 있다. 이 식은 최근 관측값에 더 큰 가중치를 주고 오래될 수록 더 작은 가중치를 준다.

이러한 가중치는 어떤 상수 비율에 따라 지수적으로 감소한다.

HW 과정은 사용하기 쉽게 소프트웨어로 완전 자동화 할 수 있다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc437.htm


## 6.4.4. 단변수 시계열 모델
### 단변수 시계열
"단변수 시계열" 용어는 일정한 시간 간격에 따라 순서대로 기록한 한 종류의 (스칼라 scala) 관측값들로 구성되는 시계열이다. 월별 평균 이산화탄소 농도와 엘니뇨 현상을 예측하가 위한 남방 진동 같은 데이터가 이에 해당한다.
  * scala: 방향 구별 없고 하나의 수치만으로 완전히 표시되는 양

보통 단변수 시계열이 한 열(column)을 구성하는 숫자로 주어지긴 하지만, 사실상 시계열 자체에 이미 시간 변수가 있는셈이다. 데이터를 시간 축에서 같은 간격으로 기록했다면, 시간 변수나 색인 등을 일일이 분명하게 보여줄 필요가 없다. 물론, 시계열로 그래프를 그릴 때는 시간 변수를 분명하게 나타내야 한다. 하지만, 시계열 모델 자체에서는 그렇게 하지 않는다.

### 내용
  1. 표본 데이터
  2. 정상성(Stationarity)
  3. 계절성(Seasonality)
  4. 일반적인 접근법
  5. 박스-젠킨스(Box-Jenkins) 접근법
  6. 박스-젠킨스 모델 판별
  7. 박스-젠킨스 모델 측정
  8. 박스-젠킨스 모델 검증
  9. 단변량 박스-젠킨스 분석의 예
  10. 계절성 데이터에 대한 박스-젠킨스 모델 분석


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc44.htm


## 6.4.4.1. 표본 데이터
### 표본 데이터
이 절에서는 아래 두 가지 데이터를 사용한다.
  1. 월별 평균 이산화탄소 농도
  2. 남방 진동


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc441.htm


## 6.4.4.1.1. 월별 평균 이산화탄소 농도
### 출처와 배경
이 데이터는 마우나 로아 관측소에서 1974년부터 1987년까지 선별한 월별 평균 이산화탄소 농도를 관측한 것이다. 이산화탄소 농도는 미 국립 해양 대기청(National Oceanic and Atmospheric Administration; NOAA) 대기 자원 연구소의 기후변화 부서에서 지구 물리학적 모니터링용 연속적인 적외선 분광기로 측정하였다. '환경 조건'의 근사치를 위해 선별작업을 하였다. 토닝과 공동 연구자들이 "마우나 로아 관측소에서 대기 중 이산화탄소: 1974년부터 1985까지 NOAA/GMCC 데이터 분석"이라는 제목으로 지구 물리 연구지에 제출한 논문을 보면 자세한 내용이 있다.(Thoning et al., "Atmospheric Carbon Dioxide at Mauna Loa Observatory: II Analysis of the NOAA/GMCC Data 1974-1985", Journal of Geophysical Research)

이 데이터는 1988년 NOAA의 짐 엘킨스가 제공한 것이다.


### 월별 이산화탄소 농도 데이터
각 행에는 이산화탄소(CO_{2}) 농도(스크립스 해양학 연구소Scripps Institution of Oceanography가 관리하는 WMO X85 몰분율 척도mole fraction scale로 표현한 건조 공기에서 혼합비)가 있다. 그리고 연, 월, 연과 월을 결합한 숫자도 있다. 이렇게 결합한 숫자는 그래프를 그릴 때 좋다.

| CO_{2} | 연도+월    | 연도 | 월    |
|--------|------------|------|-------|
| 333.13 | 1974.38    | 1974 |   5   |
| 332.09 | 1974.46    | 1974 |   6   |
| 331.10 | 1974.54    | 1974 |   7   |
| 329.14 | 1974.63    | 1974 |   8   |
| 327.36 | 1974.71    | 1974 |   9   |
| 327.29 | 1974.79    | 1974 |  10   |
| 328.23 | 1974.88    | 1974 |  11   |
| 329.55 | 1974.96    | 1974 |  12   |
|        |            |      |       |
| 330.62 | 1975.04    | 1975 |   1   |
| 331.40 | 1975.13    | 1975 |   2   |
| 331.87 | 1975.21    | 1975 |   3   |
| 333.18 | 1975.29    | 1975 |   4   |
| 333.92 | 1975.38    | 1975 |   5   |
| 333.43 | 1975.46    | 1975 |   6   |
| 331.85 | 1975.54    | 1975 |   7   |
| 330.01 | 1975.63    | 1975 |   8   |
| 328.51 | 1975.71    | 1975 |   9   |
| 328.41 | 1975.79    | 1975 |  10   |
| 329.25 | 1975.88    | 1975 |  11   |
| 330.97 | 1975.96    | 1975 |  12   |
|        |            |      |       |
| 331.60 | 1976.04    | 1976 |   1   |
| 332.60 | 1976.13    | 1976 |   2   |
| 333.57 | 1976.21    | 1976 |   3   |
| 334.72 | 1976.29    | 1976 |   4   |
| 334.68 | 1976.38    | 1976 |   5   |
| 334.17 | 1976.46    | 1976 |   6   |
| 332.96 | 1976.54    | 1976 |   7   |
| 330.80 | 1976.63    | 1976 |   8   |
| 328.98 | 1976.71    | 1976 |   9   |
| 328.57 | 1976.79    | 1976 |  10   |
| 330.20 | 1976.88    | 1976 |  11   |
| 331.58 | 1976.96    | 1976 |  12   |
|        |            |      |       |
| 332.67 | 1977.04    | 1977 |   1   |
| 333.17 | 1977.13    | 1977 |   2   |
| 334.86 | 1977.21    | 1977 |   3   |
| 336.07 | 1977.29    | 1977 |   4   |
| 336.82 | 1977.38    | 1977 |   5   |
| 336.12 | 1977.46    | 1977 |   6   |
| 334.81 | 1977.54    | 1977 |   7   |
| 332.56 | 1977.63    | 1977 |   8   |
| 331.30 | 1977.71    | 1977 |   9   |
| 331.22 | 1977.79    | 1977 |  10   |
| 332.37 | 1977.88    | 1977 |  11   |
| 333.49 | 1977.96    | 1977 |  12   |
|        |            |      |       |
| 334.71 | 1978.04    | 1978 |   1   |
| 335.23 | 1978.13    | 1978 |   2   |
| 336.54 | 1978.21    | 1978 |   3   |
| 337.79 | 1978.29    | 1978 |   4   |
| 337.95 | 1978.38    | 1978 |   5   |
| 338.00 | 1978.46    | 1978 |   6   |
| 336.37 | 1978.54    | 1978 |   7   |
| 334.47 | 1978.63    | 1978 |   8   |
| 332.46 | 1978.71    | 1978 |   9   |
| 332.29 | 1978.79    | 1978 |  10   |
| 333.76 | 1978.88    | 1978 |  11   |
| 334.80 | 1978.96    | 1978 |  12   |
|        |            |      |       |
| 336.00 | 1979.04    | 1979 |   1   |
| 336.63 | 1979.13    | 1979 |   2   |
| 337.93 | 1979.21    | 1979 |   3   |
| 338.95 | 1979.29    | 1979 |   4   |
| 339.05 | 1979.38    | 1979 |   5   |
| 339.27 | 1979.46    | 1979 |   6   |
| 337.64 | 1979.54    | 1979 |   7   |
| 335.68 | 1979.63    | 1979 |   8   |
| 333.77 | 1979.71    | 1979 |   9   |
| 334.09 | 1979.79    | 1979 |  10   |
| 335.29 | 1979.88    | 1979 |  11   |
| 336.76 | 1979.96    | 1979 |  12   |
|        |            |      |       |
| 337.77 | 1980.04    | 1980 |   1   |
| 338.26 | 1980.13    | 1980 |   2   |
| 340.10 | 1980.21    | 1980 |   3   |
| 340.88 | 1980.29    | 1980 |   4   |
| 341.47 | 1980.38    | 1980 |   5   |
| 341.31 | 1980.46    | 1980 |   6   |
| 339.41 | 1980.54    | 1980 |   7   |
| 337.74 | 1980.63    | 1980 |   8   |
| 336.07 | 1980.71    | 1980 |   9   |
| 336.07 | 1980.79    | 1980 |  10   |
| 337.22 | 1980.88    | 1980 |  11   |
| 338.38 | 1980.96    | 1980 |  12   |
|        |            |      |       |
| 339.32 | 1981.04    | 1981 |   1   |
| 340.41 | 1981.13    | 1981 |   2   |
| 341.69 | 1981.21    | 1981 |   3   |
| 342.51 | 1981.29    | 1981 |   4   |
| 343.02 | 1981.38    | 1981 |   5   |
| 342.54 | 1981.46    | 1981 |   6   |
| 340.88 | 1981.54    | 1981 |   7   |
| 338.75 | 1981.63    | 1981 |   8   |
| 337.05 | 1981.71    | 1981 |   9   |
| 337.13 | 1981.79    | 1981 |  10   |
| 338.45 | 1981.88    | 1981 |  11   |
| 339.85 | 1981.96    | 1981 |  12   |
|        |            |      |       |
| 340.90 | 1982.04    | 1982 |   1   |
| 341.70 | 1982.13    | 1982 |   2   |
| 342.70 | 1982.21    | 1982 |   3   |
| 343.65 | 1982.29    | 1982 |   4   |
| 344.28 | 1982.38    | 1982 |   5   |
| 343.42 | 1982.46    | 1982 |   6   |
| 342.02 | 1982.54    | 1982 |   7   |
| 339.97 | 1982.63    | 1982 |   8   |
| 337.84 | 1982.71    | 1982 |   9   |
| 338.00 | 1982.79    | 1982 |  10   |
| 339.20 | 1982.88    | 1982 |  11   |
| 340.63 | 1982.96    | 1982 |  12   |
|        |            |      |       |
| 341.41 | 1983.04    | 1983 |   1   |
| 342.68 | 1983.13    | 1983 |   2   |
| 343.04 | 1983.21    | 1983 |   3   |
| 345.27 | 1983.29    | 1983 |   4   |
| 345.92 | 1983.38    | 1983 |   5   |
| 345.40 | 1983.46    | 1983 |   6   |
| 344.16 | 1983.54    | 1983 |   7   |
| 342.11 | 1983.63    | 1983 |   8   |
| 340.11 | 1983.71    | 1983 |   9   |
| 340.15 | 1983.79    | 1983 |  10   |
| 341.38 | 1983.88    | 1983 |  11   |
| 343.02 | 1983.96    | 1983 |  12   |
|        |            |      |       |
| 343.87 | 1984.04    | 1984 |   1   |
| 344.59 | 1984.13    | 1984 |   2   |
| 345.11 | 1984.21    | 1984 |   3   |
| 347.07 | 1984.29    | 1984 |   4   |
| 347.38 | 1984.38    | 1984 |   5   |
| 346.78 | 1984.46    | 1984 |   6   |
| 344.96 | 1984.54    | 1984 |   7   |
| 342.71 | 1984.63    | 1984 |   8   |
| 340.86 | 1984.71    | 1984 |   9   |
| 341.13 | 1984.79    | 1984 |  10   |
| 342.84 | 1984.88    | 1984 |  11   |
| 344.32 | 1984.96    | 1984 |  12   |
|        |            |      |       |
| 344.88 | 1985.04    | 1985 |   1   |
| 345.62 | 1985.13    | 1985 |   2   |
| 347.23 | 1985.21    | 1985 |   3   |
| 347.62 | 1985.29    | 1985 |   4   |
| 348.53 | 1985.38    | 1985 |   5   |
| 347.87 | 1985.46    | 1985 |   6   |
| 346.00 | 1985.54    | 1985 |   7   |
| 343.86 | 1985.63    | 1985 |   8   |
| 342.55 | 1985.71    | 1985 |   9   |
| 342.57 | 1985.79    | 1985 |  10   |
| 344.11 | 1985.88    | 1985 |  11   |
| 345.49 | 1985.96    | 1985 |  12   |
|        |            |      |       |
| 346.04 | 1986.04    | 1986 |   1   |
| 346.70 | 1986.13    | 1986 |   2   |
| 347.38 | 1986.21    | 1986 |   3   |
| 349.38 | 1986.29    | 1986 |   4   |
| 349.93 | 1986.38    | 1986 |   5   |
| 349.26 | 1986.46    | 1986 |   6   |
| 347.44 | 1986.54    | 1986 |   7   |
| 345.55 | 1986.63    | 1986 |   8   |
| 344.21 | 1986.71    | 1986 |   9   |
| 343.67 | 1986.79    | 1986 |  10   |
| 345.09 | 1986.88    | 1986 |  11   |
| 346.27 | 1986.96    | 1986 |  12   |
|        |            |      |       |
| 347.33 | 1987.04    | 1987 |   1   |
| 347.82 | 1987.13    | 1987 |   2   |
| 349.29 | 1987.21    | 1987 |   3   |
| 350.91 | 1987.29    | 1987 |   4   |
| 351.71 | 1987.38    | 1987 |   5   |
| 350.94 | 1987.46    | 1987 |   6   |
| 349.10 | 1987.54    | 1987 |   7   |
| 346.77 | 1987.63    | 1987 |   8   |
| 345.73 | 1987.71    | 1987 |   9   |

원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc4411.htm


## 6.4.4.1.2. 남방 진동 데이터
### 출처와 배경
남방 진동은 해수면에서 기압계로 타히티(Tahiti)와 다윈섬(the Darwin Islands)의 기압차로 정의한다. 남방 진동은 차례차례 세계 기후 변화를 이끄는 원인으로 불리는 엘니뇨의 예측 변수(predictor)이다. 특별히 반복적으로 -1보다 작게 나타나는 남방 진동값을 엘니뇨로 정의한다. **메모: ** 두 번째 열에서 소수점 값은 (월 값 - 0.5)/12 로 구한 것이다.

| 남방 진동            | 연도 + 월       | 연도 | 월    |
|----------------------|-----------------|------|-------|
| -0.7                 | 1955.04         | 1955 |  1    |
|  1.3                 | 1955.13         | 1955 |  2    |
|  0.1                 | 1955.21         | 1955 |  3    |
| -0.9                 | 1955.29         | 1955 |  4    |
|  0.8                 | 1955.38         | 1955 |  5    |
|  1.6                 | 1955.46         | 1955 |  6    |
|  1.7                 | 1955.54         | 1955 |  7    |
|  1.4                 | 1955.63         | 1955 |  8    |
|  1.4                 | 1955.71         | 1955 |  9    |
|  1.5                 | 1955.79         | 1955 | 10    |
|  1.4                 | 1955.88         | 1955 | 11    |
|  0.9                 | 1955.96         | 1955 | 12    |
|                      |                 |      |       |
|  1.2                 | 1956.04         | 1956 |  1    |
|  1.1                 | 1956.13         | 1956 |  2    |
|  0.9                 | 1956.21         | 1956 |  3    |
|  1.1                 | 1956.29         | 1956 |  4    |
|  1.4                 | 1956.38         | 1956 |  5    |
|  1.2                 | 1956.46         | 1956 |  6    |
|  1.1                 | 1956.54         | 1956 |  7    |
|  1.0                 | 1956.63         | 1956 |  8    |
|  0.0                 | 1956.71         | 1956 |  9    |
|  1.9                 | 1956.79         | 1956 | 10    |
|  0.1                 | 1956.88         | 1956 | 11    |
|  0.9                 | 1956.96         | 1956 | 12    |
|                      |                 |      |       |
|  0.4                 | 1957.04         | 1957 |  1    |
| -0.4                 | 1957.13         | 1957 |  2    |
| -0.4                 | 1957.21         | 1957 |  3    |
|  0.0                 | 1957.29         | 1957 |  4    |
| -1.1                 | 1957.38         | 1957 |  5    |
| -0.4                 | 1957.46         | 1957 |  6    |
|  0.1                 | 1957.54         | 1957 |  7    |
| -1.1                 | 1957.63         | 1957 |  8    |
| -1.0                 | 1957.71         | 1957 |  9    |
| -0.1                 | 1957.79         | 1957 | 10    |
| -1.2                 | 1957.88         | 1957 | 11    |
| -0.5                 | 1957.96         | 1957 | 12    |
|                      |                 |      |       |
| -1.9                 | 1958.04         | 1958 |  1    |
| -0.7                 | 1958.13         | 1958 |  2    |
| -0.3                 | 1958.21         | 1958 |  3    |
|  0.1                 | 1958.29         | 1958 |  4    |
| -1.3                 | 1958.38         | 1958 |  5    |
| -0.3                 | 1958.46         | 1958 |  6    |
|  0.3                 | 1958.54         | 1958 |  7    |
|  0.7                 | 1958.63         | 1958 |  8    |
| -0.4                 | 1958.71         | 1958 |  9    |
| -0.4                 | 1958.79         | 1958 | 10    |
| -0.6                 | 1958.88         | 1958 | 11    |
| -0.8                 | 1958.96         | 1958 | 12    |
|                      |                 |      |       |
| -0.9                 | 1959.04         | 1959 |  1    |
| -1.5                 | 1959.13         | 1959 |  2    |
|  0.8                 | 1959.21         | 1959 |  3    |
|  0.2                 | 1959.29         | 1959 |  4    |
|  0.2                 | 1959.38         | 1959 |  5    |
| -0.9                 | 1959.46         | 1959 |  6    |
| -0.5                 | 1959.54         | 1959 |  7    |
| -0.6                 | 1959.63         | 1959 |  8    |
|  0.0                 | 1959.71         | 1959 |  9    |
|  0.3                 | 1959.79         | 1959 | 10    |
|  0.9                 | 1959.88         | 1959 | 11    |
|  0.8                 | 1959.96         | 1959 | 12    |
|                      |                 |      |       |
|  0.0                 | 1960.04         | 1960 |  1    |
| -0.2                 | 1960.13         | 1960 |  2    |
|  0.5                 | 1960.21         | 1960 |  3    |
|  0.9                 | 1960.29         | 1960 |  4    |
|  0.2                 | 1960.38         | 1960 |  5    |
| -0.5                 | 1960.46         | 1960 |  6    |
|  0.4                 | 1960.54         | 1960 |  7    |
|  0.5                 | 1960.63         | 1960 |  8    |
|  0.7                 | 1960.71         | 1960 |  9    |
| -0.1                 | 1960.79         | 1960 | 10    |
|  0.6                 | 1960.88         | 1960 | 11    |
|  0.7                 | 1960.96         | 1960 | 12    |
|                      |                 |      |       |
| -0.4                 | 1961.04         | 1961 |  1    |
|  0.5                 | 1961.13         | 1961 |  2    |
| -2.6                 | 1961.21         | 1961 |  3    |
|  1.1                 | 1961.29         | 1961 |  4    |
|  0.2                 | 1961.38         | 1961 |  5    |
| -0.4                 | 1961.46         | 1961 |  6    |
|  0.1                 | 1961.54         | 1961 |  7    |
| -0.3                 | 1961.63         | 1961 |  8    |
|  0.0                 | 1961.71         | 1961 |  9    |
| -0.8                 | 1961.79         | 1961 | 10    |
|  0.7                 | 1961.88         | 1961 | 11    |
|  1.4                 | 1961.96         | 1961 | 12    |
|                      |                 |      |       |
|  1.7                 | 1962.04         | 1962 |  1    |
| -0.5                 | 1962.13         | 1962 |  2    |
| -0.4                 | 1962.21         | 1962 |  3    |
|  0.0                 | 1962.29         | 1962 |  4    |
|  1.2                 | 1962.38         | 1962 |  5    |
|  0.5                 | 1962.46         | 1962 |  6    |
| -0.1                 | 1962.54         | 1962 |  7    |
|  0.3                 | 1962.63         | 1962 |  8    |
|  0.5                 | 1962.71         | 1962 |  9    |
|  0.9                 | 1962.79         | 1962 | 10    |
|  0.2                 | 1962.88         | 1962 | 11    |
|  0.0                 | 1962.96         | 1962 | 12    |
|                      |                 |      |       |
|  0.8                 | 1963.04         | 1963 |  1    |
|  0.3                 | 1963.13         | 1963 |  2    |
|  0.6                 | 1963.21         | 1963 |  3    |
|  0.9                 | 1963.29         | 1963 |  4    |
|  0.0                 | 1963.38         | 1963 |  5    |
| -1.5                 | 1963.46         | 1963 |  6    |
| -0.3                 | 1963.54         | 1963 |  7    |
| -0.4                 | 1963.63         | 1963 |  8    |
| -0.7                 | 1963.71         | 1963 |  9    |
| -1.6                 | 1963.79         | 1963 | 10    |
| -1.0                 | 1963.88         | 1963 | 11    |
| -1.4                 | 1963.96         | 1963 | 12    |
|                      |                 |      |       |
| -0.5                 | 1964.04         | 1964 |  1    |
| -0.2                 | 1964.13         | 1964 |  2    |
|  0.6                 | 1964.21         | 1964 |  3    |
|  1.7                 | 1964.29         | 1964 |  4    |
| -0.2                 | 1964.38         | 1964 |  5    |
|  0.7                 | 1964.46         | 1964 |  6    |
|  0.5                 | 1964.54         | 1964 |  7    |
|  1.4                 | 1964.63         | 1964 |  8    |
|  1.3                 | 1964.71         | 1964 |  9    |
|  1.3                 | 1964.79         | 1964 | 10    |
|  0.0                 | 1964.88         | 1964 | 11    |
| -0.5                 | 1964.96         | 1964 | 12    |
|                      |                 |      |       |
| -0.5                 | 1965.04         | 1965 |  1    |
|  0.0                 | 1965.13         | 1965 |  2    |
|  0.2                 | 1965.21         | 1965 |  3    |
| -1.1                 | 1965.29         | 1965 |  4    |
|  0.0                 | 1965.38         | 1965 |  5    |
| -1.5                 | 1965.46         | 1965 |  6    |
| -2.3                 | 1965.54         | 1965 |  7    |
| -1.3                 | 1965.63         | 1965 |  8    |
| -1.4                 | 1965.71         | 1965 |  9    |
| -1.2                 | 1965.79         | 1965 | 10    |
| -1.8                 | 1965.88         | 1965 | 11    |
|  0.0                 | 1965.96         | 1965 | 12    |
|                      |                 |      |       |
| -1.4                 | 1966.04         | 1966 |  1    |
| -0.5                 | 1966.13         | 1966 |  2    |
| -1.6                 | 1966.21         | 1966 |  3    |
| -0.7                 | 1966.29         | 1966 |  4    |
| -0.6                 | 1966.38         | 1966 |  5    |
|  0.0                 | 1966.46         | 1966 |  6    |
| -0.1                 | 1966.54         | 1966 |  7    |
|  0.3                 | 1966.63         | 1966 |  8    |
| -0.3                 | 1966.71         | 1966 |  9    |
| -0.3                 | 1966.79         | 1966 | 10    |
| -0.1                 | 1966.88         | 1966 | 11    |
| -0.5                 | 1966.96         | 1966 | 12    |
|                      |                 |      |       |
|  1.5                 | 1967.04         | 1967 |  1    |
|  1.2                 | 1967.13         | 1967 |  2    |
|  0.8                 | 1967.21         | 1967 |  3    |
| -0.2                 | 1967.29         | 1967 |  4    |
| -0.4                 | 1967.38         | 1967 |  5    |
|  0.6                 | 1967.46         | 1967 |  6    |
|  0.0                 | 1967.54         | 1967 |  7    |
|  0.4                 | 1967.63         | 1967 |  8    |
|  0.5                 | 1967.71         | 1967 |  9    |
| -0.2                 | 1967.79         | 1967 | 10    |
| -0.7                 | 1967.88         | 1967 | 11    |
| -0.7                 | 1967.96         | 1967 | 12    |
|                      |                 |      |       |
|  0.5                 | 1968.04         | 1968 |  1    |
|  0.8                 | 1968.13         | 1968 |  2    |
| -0.5                 | 1968.21         | 1968 |  3    |
| -0.3                 | 1968.29         | 1968 |  4    |
|  1.2                 | 1968.38         | 1968 |  5    |
|  1.4                 | 1968.46         | 1968 |  6    |
|  0.6                 | 1968.54         | 1968 |  7    |
| -0.1                 | 1968.63         | 1968 |  8    |
| -0.3                 | 1968.71         | 1968 |  9    |
| -0.3                 | 1968.79         | 1968 | 10    |
| -0.4                 | 1968.88         | 1968 | 11    |
|  0.0                 | 1968.96         | 1968 | 12    |
|                      |                 |      |       |
| -1.4                 | 1969.04         | 1969 |  1    |
|  0.8                 | 1969.13         | 1969 |  2    |
| -0.1                 | 1969.21         | 1969 |  3    |
| -0.8                 | 1969.29         | 1969 |  4    |
| -0.8                 | 1969.38         | 1969 |  5    |
| -0.2                 | 1969.46         | 1969 |  6    |
| -0.7                 | 1969.54         | 1969 |  7    |
| -0.6                 | 1969.63         | 1969 |  8    |
| -1.0                 | 1969.71         | 1969 |  9    |
| -1.4                 | 1969.79         | 1969 | 10    |
| -0.1                 | 1969.88         | 1969 | 11    |
|  0.3                 | 1969.96         | 1969 | 12    |
|                      |                 |      |       |
| -1.2                 | 1970.04         | 1970 |  1    |
| -1.2                 | 1970.13         | 1970 |  2    |
|  0.0                 | 1970.21         | 1970 |  3    |
| -0.5                 | 1970.29         | 1970 |  4    |
|  0.1                 | 1970.38         | 1970 |  5    |
|  1.1                 | 1970.46         | 1970 |  6    |
| -0.6                 | 1970.54         | 1970 |  7    |
|  0.3                 | 1970.63         | 1970 |  8    |
|  1.2                 | 1970.71         | 1970 |  9    |
|  0.8                 | 1970.79         | 1970 | 10    |
|  1.8                 | 1970.88         | 1970 | 11    |
|  1.8                 | 1970.96         | 1970 | 12    |
|                      |                 |      |       |
|  0.2                 | 1971.04         | 1971 |  1    |
|  1.4                 | 1971.13         | 1971 |  2    |
|  2.0                 | 1971.21         | 1971 |  3    |
|  2.6                 | 1971.29         | 1971 |  4    |
|  0.9                 | 1971.38         | 1971 |  5    |
|  0.2                 | 1971.46         | 1971 |  6    |
|  0.1                 | 1971.54         | 1971 |  7    |
|  1.4                 | 1971.63         | 1971 |  8    |
|  1.5                 | 1971.71         | 1971 |  9    |
|  1.8                 | 1971.79         | 1971 | 10    |
|  0.5                 | 1971.88         | 1971 | 11    |
|  0.1                 | 1971.96         | 1971 | 12    |
|                      |                 |      |       |
|  0.3                 | 1972.04         | 1972 |  1    |
|  0.6                 | 1972.13         | 1972 |  2    |
|  0.1                 | 1972.21         | 1972 |  3    |
| -0.5                 | 1972.29         | 1972 |  4    |
| -2.1                 | 1972.38         | 1972 |  5    |
| -1.7                 | 1972.46         | 1972 |  6    |
| -1.9                 | 1972.54         | 1972 |  7    |
| -1.1                 | 1972.63         | 1972 |  8    |
| -1.5                 | 1972.71         | 1972 |  9    |
| -1.1                 | 1972.79         | 1972 | 10    |
| -0.4                 | 1972.88         | 1972 | 11    |
| -1.5                 | 1972.96         | 1972 | 12    |
|                      |                 |      |       |
| -0.4                 | 1973.04         | 1973 |  1    |
| -1.5                 | 1973.13         | 1973 |  2    |
|  0.2                 | 1973.21         | 1973 |  3    |
| -0.4                 | 1973.29         | 1973 |  4    |
|  0.3                 | 1973.38         | 1973 |  5    |
|  1.2                 | 1973.46         | 1973 |  6    |
|  0.5                 | 1973.54         | 1973 |  7    |
|  1.2                 | 1973.63         | 1973 |  8    |
|  1.3                 | 1973.71         | 1973 |  9    |
|  0.6                 | 1973.79         | 1973 | 10    |
|  2.9                 | 1973.88         | 1973 | 11    |
|  1.7                 | 1973.96         | 1973 | 12    |
|                      |                 |      |       |
|  2.2                 | 1974.04         | 1974 |  1    |
|  1.5                 | 1974.13         | 1974 |  2    |
|  2.1                 | 1974.21         | 1974 |  3    |
|  1.3                 | 1974.29         | 1974 |  4    |
|  1.3                 | 1974.38         | 1974 |  5    |
|  0.1                 | 1974.46         | 1974 |  6    |
|  1.2                 | 1974.54         | 1974 |  7    |
|  0.5                 | 1974.63         | 1974 |  8    |
|  1.1                 | 1974.71         | 1974 |  9    |
|  0.8                 | 1974.79         | 1974 | 10    |
| -0.4                 | 1974.88         | 1974 | 11    |
|  0.0                 | 1974.96         | 1974 | 12    |
|                      |                 |      |       |
| -0.6                 | 1975.04         | 1975 |  1    |
|  0.4                 | 1975.13         | 1975 |  2    |
|  1.1                 | 1975.21         | 1975 |  3    |
|  1.5                 | 1975.29         | 1975 |  4    |
|  0.5                 | 1975.38         | 1975 |  5    |
|  1.7                 | 1975.46         | 1975 |  6    |
|  2.1                 | 1975.54         | 1975 |  7    |
|  2.0                 | 1975.63         | 1975 |  8    |
|  2.2                 | 1975.71         | 1975 |  9    |
|  1.7                 | 1975.79         | 1975 | 10    |
|  1.3                 | 1975.88         | 1975 | 11    |
|  2.0                 | 1975.96         | 1975 | 12    |
|                      |                 |      |       |
|  1.2                 | 1976.04         | 1976 |  1    |
|  1.2                 | 1976.13         | 1976 |  2    |
|  1.3                 | 1976.21         | 1976 |  3    |
|  0.2                 | 1976.29         | 1976 |  4    |
|  0.6                 | 1976.38         | 1976 |  5    |
| -0.1                 | 1976.46         | 1976 |  6    |
| -1.2                 | 1976.54         | 1976 |  7    |
| -1.5                 | 1976.63         | 1976 |  8    |
| -1.2                 | 1976.71         | 1976 |  9    |
|  0.2                 | 1976.79         | 1976 | 10    |
|  0.7                 | 1976.88         | 1976 | 11    |
| -0.5                 | 1976.96         | 1976 | 12    |
|                      |                 |      |       |
| -0.5                 | 1977.04         | 1977 |  1    |
|  0.8                 | 1977.13         | 1977 |  2    |
| -1.2                 | 1977.21         | 1977 |  3    |
| -1.3                 | 1977.29         | 1977 |  4    |
| -1.1                 | 1977.38         | 1977 |  5    |
| -2.3                 | 1977.46         | 1977 |  6    |
| -1.5                 | 1977.54         | 1977 |  7    |
| -1.4                 | 1977.63         | 1977 |  8    |
| -0.9                 | 1977.71         | 1977 |  9    |
| -1.4                 | 1977.79         | 1977 | 10    |
| -1.6                 | 1977.88         | 1977 | 11    |
| -1.3                 | 1977.96         | 1977 | 12    |
|                      |                 |      |       |
| -0.5                 | 1978.04         | 1978 |  1    |
| -2.6                 | 1978.13         | 1978 |  2    |
| -0.8                 | 1978.21         | 1978 |  3    |
| -0.9                 | 1978.29         | 1978 |  4    |
|  1.3                 | 1978.38         | 1978 |  5    |
|  0.4                 | 1978.46         | 1978 |  6    |
|  0.4                 | 1978.54         | 1978 |  7    |
|  0.1                 | 1978.63         | 1978 |  8    |
|  0.0                 | 1978.71         | 1978 |  9    |
| -0.8                 | 1978.79         | 1978 | 10    |
| -0.1                 | 1978.88         | 1978 | 11    |
| -0.2                 | 1978.96         | 1978 | 12    |
|                      |                 |      |       |
| -0.5                 | 1979.04         | 1979 |  1    |
|  0.6                 | 1979.13         | 1979 |  2    |
| -0.5                 | 1979.21         | 1979 |  3    |
| -0.7                 | 1979.29         | 1979 |  4    |
|  0.5                 | 1979.38         | 1979 |  5    |
|  0.6                 | 1979.46         | 1979 |  6    |
|  1.3                 | 1979.54         | 1979 |  7    |
| -0.7                 | 1979.63         | 1979 |  8    |
|  0.1                 | 1979.71         | 1979 |  9    |
| -0.4                 | 1979.79         | 1979 | 10    |
| -0.6                 | 1979.88         | 1979 | 11    |
| -0.9                 | 1979.96         | 1979 | 12    |
|                      |                 |      |       |
|  0.3                 | 1980.04         | 1980 |  1    |
|  0.0                 | 1980.13         | 1980 |  2    |
| -1.1                 | 1980.21         | 1980 |  3    |
| -1.7                 | 1980.29         | 1980 |  4    |
| -0.3                 | 1980.38         | 1980 |  5    |
| -0.7                 | 1980.46         | 1980 |  6    |
| -0.2                 | 1980.54         | 1980 |  7    |
| -0.1                 | 1980.63         | 1980 |  8    |
| -0.5                 | 1980.71         | 1980 |  9    |
| -0.3                 | 1980.79         | 1980 | 10    |
| -0.5                 | 1980.88         | 1980 | 11    |
| -0.2                 | 1980.96         | 1980 | 12    |
|                      |                 |      |       |
|  0.3                 | 1981.04         | 1981 |  1    |
| -0.5                 | 1981.13         | 1981 |  2    |
| -2.0                 | 1981.21         | 1981 |  3    |
| -0.6                 | 1981.29         | 1981 |  4    |
|  0.8                 | 1981.38         | 1981 |  5    |
|  1.6                 | 1981.46         | 1981 |  6    |
|  0.8                 | 1981.54         | 1981 |  7    |
|  0.4                 | 1981.63         | 1981 |  8    |
|  0.3                 | 1981.71         | 1981 |  9    |
| -0.7                 | 1981.79         | 1981 | 10    |
|  0.1                 | 1981.88         | 1981 | 11    |
|  0.4                 | 1981.96         | 1981 | 12    |
|                      |                 |      |       |
|  1.0                 | 1982.04         | 1982 |  1    |
|  0.0                 | 1982.13         | 1982 |  2    |
|  0.0                 | 1982.21         | 1982 |  3    |
| -0.1                 | 1982.29         | 1982 |  4    |
| -0.6                 | 1982.38         | 1982 |  5    |
| -2.5                 | 1982.46         | 1982 |  6    |
| -2.0                 | 1982.54         | 1982 |  7    |
| -2.7                 | 1982.63         | 1982 |  8    |
| -1.9                 | 1982.71         | 1982 |  9    |
| -2.2                 | 1982.79         | 1982 | 10    |
| -3.2                 | 1982.88         | 1982 | 11    |
| -2.5                 | 1982.96         | 1982 | 12    |
|                      |                 |      |       |
| -3.4                 | 1983.04         | 1983 |  1    |
| -3.5                 | 1983.13         | 1983 |  2    |
| -3.2                 | 1983.21         | 1983 |  3    |
| -2.1                 | 1983.29         | 1983 |  4    |
|  0.9                 | 1983.38         | 1983 |  5    |
| -0.5                 | 1983.46         | 1983 |  6    |
| -0.9                 | 1983.54         | 1983 |  7    |
| -0.4                 | 1983.63         | 1983 |  8    |
|  0.9                 | 1983.71         | 1983 |  9    |
|  0.3                 | 1983.79         | 1983 | 10    |
| -0.1                 | 1983.88         | 1983 | 11    |
| -0.1                 | 1983.96         | 1983 | 12    |
|                      |                 |      |       |
|  0.0                 | 1984.04         | 1984 |  1    |
|  0.4                 | 1984.13         | 1984 |  2    |
| -0.8                 | 1984.21         | 1984 |  3    |
|  0.4                 | 1984.29         | 1984 |  4    |
|  0.0                 | 1984.38         | 1984 |  5    |
| -1.2                 | 1984.46         | 1984 |  6    |
|  0.0                 | 1984.54         | 1984 |  7    |
|  0.1                 | 1984.63         | 1984 |  8    |
|  0.1                 | 1984.71         | 1984 |  9    |
| -0.6                 | 1984.79         | 1984 | 10    |
|  0.3                 | 1984.88         | 1984 | 11    |
| -0.3                 | 1984.96         | 1984 | 12    |
|                      |                 |      |       |
| -0.5                 | 1985.04         | 1985 |  1    |
|  0.8                 | 1985.13         | 1985 |  2    |
|  0.2                 | 1985.21         | 1985 |  3    |
|  1.4                 | 1985.29         | 1985 |  4    |
| -0.2                 | 1985.38         | 1985 |  5    |
| -1.4                 | 1985.46         | 1985 |  6    |
| -0.3                 | 1985.54         | 1985 |  7    |
|  0.7                 | 1985.63         | 1985 |  8    |
|  0.0                 | 1985.71         | 1985 |  9    |
| -0.8                 | 1985.79         | 1985 | 10    |
| -0.4                 | 1985.88         | 1985 | 11    |
|  0.1                 | 1985.96         | 1985 | 12    |
|                      |                 |      |       |
|  0.8                 | 1986.04         | 1986 |  1    |
| -1.2                 | 1986.13         | 1986 |  2    |
| -0.1                 | 1986.21         | 1986 |  3    |
|  0.1                 | 1986.29         | 1986 |  4    |
| -0.6                 | 1986.38         | 1986 |  5    |
|  1.0                 | 1986.46         | 1986 |  6    |
|  0.1                 | 1986.54         | 1986 |  7    |
| -0.9                 | 1986.63         | 1986 |  8    |
| -0.5                 | 1986.71         | 1986 |  9    |
|  0.6                 | 1986.79         | 1986 | 10    |
| -1.6                 | 1986.88         | 1986 | 11    |
| -1.6                 | 1986.96         | 1986 | 12    |
|                      |                 |      |       |
| -0.7                 | 1987.04         | 1987 |  1    |
| -1.4                 | 1987.13         | 1987 |  2    |
| -2.0                 | 1987.21         | 1987 |  3    |
| -2.7                 | 1987.29         | 1987 |  4    |
| -2.0                 | 1987.38         | 1987 |  5    |
| -2.7                 | 1987.46         | 1987 |  6    |
| -1.8                 | 1987.54         | 1987 |  7    |
| -1.7                 | 1987.63         | 1987 |  8    |
| -1.1                 | 1987.71         | 1987 |  9    |
| -0.7                 | 1987.79         | 1987 | 10    |
| -0.1                 | 1987.88         | 1987 | 11    |
| -0.6                 | 1987.96         | 1987 | 12    |
|                      |                 |      |       |
| -0.3                 | 1988.04         | 1988 |  1    |
| -0.6                 | 1988.13         | 1988 |  2    |
|  0.1                 | 1988.21         | 1988 |  3    |
|  0.0                 | 1988.29         | 1988 |  4    |
|  1.1                 | 1988.38         | 1988 |  5    |
| -0.3                 | 1988.46         | 1988 |  6    |
|  1.1                 | 1988.54         | 1988 |  7    |
|  1.4                 | 1988.63         | 1988 |  8    |
|  1.9                 | 1988.71         | 1988 |  9    |
|  1.5                 | 1988.79         | 1988 | 10    |
|  1.9                 | 1988.88         | 1988 | 11    |
|  1.1                 | 1988.96         | 1988 | 12    |
|                      |                 |      |       |
|  1.5                 | 1989.04         | 1989 |  1    |
|  1.1                 | 1989.13         | 1989 |  2    |
|  0.6                 | 1989.21         | 1989 |  3    |
|  1.6                 | 1989.29         | 1989 |  4    |
|  1.2                 | 1989.38         | 1989 |  5    |
|  0.5                 | 1989.46         | 1989 |  6    |
|  0.8                 | 1989.54         | 1989 |  7    |
| -0.8                 | 1989.63         | 1989 |  8    |
|  0.6                 | 1989.71         | 1989 |  9    |
|  0.6                 | 1989.79         | 1989 | 10    |
| -0.4                 | 1989.88         | 1989 | 11    |
| -0.7                 | 1989.96         | 1989 | 12    |
|                      |                 |      |       |
| -0.2                 | 1990.04         | 1990 |  1    |
| -2.4                 | 1990.13         | 1990 |  2    |
| -1.2                 | 1990.21         | 1990 |  3    |
|  0.0                 | 1990.29         | 1990 |  4    |
|  1.1                 | 1990.38         | 1990 |  5    |
|  0.0                 | 1990.46         | 1990 |  6    |
|  0.5                 | 1990.54         | 1990 |  7    |
| -0.5                 | 1990.63         | 1990 |  8    |
| -0.8                 | 1990.71         | 1990 |  9    |
|  0.1                 | 1990.79         | 1990 | 10    |
| -0.7                 | 1990.88         | 1990 | 11    |
| -0.4                 | 1990.96         | 1990 | 12    |
|                      |                 |      |       |
|  0.6                 | 1991.04         | 1991 |  1    |
| -0.1                 | 1991.13         | 1991 |  2    |
| -1.4                 | 1991.21         | 1991 |  3    |
| -1.0                 | 1991.29         | 1991 |  4    |
| -1.5                 | 1991.38         | 1991 |  5    |
| -0.5                 | 1991.46         | 1991 |  6    |
| -0.2                 | 1991.54         | 1991 |  7    |
| -0.9                 | 1991.63         | 1991 |  8    |
| -1.8                 | 1991.71         | 1991 |  9    |
| -1.5                 | 1991.79         | 1991 | 10    |
| -0.8                 | 1991.88         | 1991 | 11    |
| -2.3                 | 1991.96         | 1991 | 12    |
|                      |                 |      |       |
| -3.4                 | 1992.04         | 1992 |  1    |
| -1.4                 | 1992.13         | 1992 |  2    |
| -3.0                 | 1992.21         | 1992 |  3    |
| -1.4                 | 1992.29         | 1992 |  4    |
|  0.0                 | 1992.38         | 1992 |  5    |
| -1.2                 | 1992.46         | 1992 |  6    |
| -0.8                 | 1992.54         | 1992 |  7    |
|  0.0                 | 1992.63         | 1992 |  8    |
|  0.0                 | 1992.71         | 1992 |  9    |
| -1.9                 | 1992.79         | 1992 | 10    |
| -0.9                 | 1992.88         | 1992 | 11    |
| -1.1                 | 1992.96         | 1992 | 12    |


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc4412.htm


## 6.4.4.2. 정상성(Stationarity)
### 정상성
흔히 많은 시계열 기법들은 데이터가 정상적(stationary)이라고 가정한다.

정상 과정(stationary process)은 평균, 분산, 자기상관 구조가 시간에 따라서 변하지 않는 특징이 있다. 정상성은 정확한 수학적 용어로 정의할 수 있지만, 이 글에서는 추세를 무시하면, 분산이 일정하고, 시간에 따라 일정한 자기상관 구조가 있으며, 주기적인 변동(계절성)이 없는 평평한 시계열 정도로 이야기하면 충분하다.

실용적인 목적에서 보통 연속 /ㅎ(run sequence plot)를 보고 정상성을 판단할 수 있다.

### 정상성을 다루기 위한 변환
시계열이 정상(stationary)적이지 않으면, 다음과 같은 기법으로 시계열을 변환해서 종종 정상성을 확인할 수 있다.
  1. 주어진 시계열 Z_{t}에서 다음과 같이 차이를 구하여 새로운 시계열을 만든다.
      Y_{i} = Z_{i} - Z_{i-1}
    차이로 구한 데이터는 원본 데이터보다 한 점이 적다. 한 번 이상 차이를 구할 수 있긴 하지만, 보통 한 번만 구해도 충분하다.
  2. 데이터에 추세가 있다면, 데이터를 어떤 종류의 곡선으로 맞추고 데이터와 곡선과의 차이를 모델링한다. 단순히 장기적인 추세를 없애려고 곡선으로 맞추기 때문에 보통 직선으로 단순하게 맞춘다.
  3. 일정하지 않은 분산이 있는 경우는, 시계열에 로그나 제곱근을 취하여 분산을 안정시킨다. 데이터에 음수가 있는 경우는 모든 데이터 값을 상수로 만드는 적절한 상수를 더한다. 이 상수는 미래 예측값을 구할 때 다시 빼면 된다.

일정한 위치와 척도를 나타내는 시계열을 만들기 위해 위의 기법을 소개하였다. 계절성에 정상성이 없더라도, 보통 시계열 모델에 포함되어있다.


### 예제
다음은 월별 이산화탄소 농도 데이터 그래프이다.


### 연속 순서 그래프
![](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/co2runsq.gif)

데이터의 연속 순서 그래프가 증가 추세를 나타낸다. 육안으로 이 그래프를 보면 증가 추세를 없애려면 단순하게 직선 함수로 맞춰도 충분하다는 것을 알 수 있다.

이 그래프에서 주기적인 성질도 볼 수 있다. 이 부분은 다음 절에서 다룰 것이다.


### 선형 추세 제거
![](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/co2res.gif)
이 그래프는 맞춘 직선 함수와 원본 데이터의 차이를 구한 것이다. 선형 추세를 없앤 후에, 차이의 패턴이 어떤 규칙에 따르는 것처럼 보이지만, 연속 순서 그래프는 데이터가 일정한 위치에서 일정한 분산을 가지고 나타나는 모습을 보여주고 있다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc442.htm


## 6.4.4.3. 계절성(Seasonality)
### 계절성
많은 시게열은 계절성을 나타낸다. 계절성은 주기적인 변동을 의미한다. 예를 들면, 소매 형태 판매량의 시계열은 크리스마스 기간에 최고조에 다다르고 나서 기간이 지나면 감소한다. 그래서 소매 형태 판매량의 시계열은 보통 9월부터 12월까지 증가하는 추세를, 1월과 2월에 감소하는 추세를 보인다.

경제 분야 시게열에서 계절성은 아주 흔한 현상이지만, 공학이나 과학 데이터에서는 그렇지 않다.

계절성이 나타나면, 시계열 모델에서 반드시 고려해야 한다. 이 절에서는 계절성을 감지하는 기법을 살펴보자. 계절성을 모델링하는 작업은 이후의 절에서 다루겠다.


### 계절성을 감지하기
계절성을 감지하기 위해 다음의 기법을 사용할 수 있다.
  1. 연속 순서 그래프가 종종 계절성을 보여준다.
  2. 계절적인 부 시계열(subseries) 그래프는 계절성을 보여주기 위한 전문적인 기법이다.
  3. 다중 상자 그래프(multiple box plots)도 계절적인 부 시계열 그래프에서 계절성을 감지하기 위해 사용할 수 있다.
  4. 자기상관 그래프는 계절성을 확인하는데 도움이 된다.

아래는 각 그래프에 해당하는 예제이다.

어떤 시계열을 분석할 때 첫 단계에서 연속 순서 그래프를 사용하길 추천한다. 가끔 이 그래프에서 계절성이 나타나더라도, 계절적인 부 시계열이나 상자 그래프로 더욱 분명하게 확인할 수 있다. 계절적인 부 시계열 그래프는 계절적인 차이와 그룹 내부 패턴 모두를 확인하는데 매우 좋다. 상자 그래프는 (그룹 패턴들 사이의) 계절적인 차이를 꽤 잘 보여주지만, 그룹 내부의 패턴을 보여주지는 않는다. 하지만, 큰 데이터가 있을 때, 보통 상자 그래프가 계절적인 부 시계열 그래프보다 읽기 쉽다.

계절적인 부 시계열 그래프와 상자 그래프 모두 계절 주기를 알고 있다고 가정한다. 사실 대부분의 경우에, 분석하는 사람은 이것을 알게 된다. 예를 들면, 월별 데이터에서 1년에 12달이 있으니 주기는 12이다. 하지만 주기를 모르면, 자기 상관 그래프를 사용하자. 의미있는 계절성이 있으면, 자기 상관 그래프에서 주기와 같은 어떤 뒤처짐 값에서 뾰족한 막대 모양이 나타난다. 예를 들면, 월별 데이터에 계절성 효과가 있으면, 12, 24, 36 등의 뒤처짐 값에서 (뒤처짐 값이 커질 수록 막대 그래프 크기가 줄어들긴 하지만) 의미있는 막대 그래프가 나타날 것이다.


### 계절성이 없는 예제
다음은 엘니뇨를 예측하기 위한 남방 진동 데이터를 나타내는 그래프이다.


### 연속 순서 그래프
![](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/oscrunsq.gif)

연속 순서 그래프에서 분명하게 나타나는 주기적 패턴이 없다.


### 계절적인 부 시계열 그래프
![](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/oscseas.gif)

각 월의 평균값이 거의 비슷하다. 분명하게 나타나는 패턴이 없다.


### 상자 그래프
![](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/oscboxpl.gif)

계절적인 부 시계열 그래프처럼, 분명하게 나타나는 패턴이 없다.

관측값이 상당히 많아서 상자 그래프가 계절적인 부 시계열 그래프보다 월별 차이를 더 잘 보여준다.


### 계절성이 있는 예제
다음은 월별 이산화탄소 농도 데이터를 나타내는 그래프이다. 선형 추세는 제거한 것이다.

![](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/co2res.gif)

이 그래프는 주기적인 성질을 나타낸다. 하지만, 이 그래프에서 계절성이 있다고 판단하기는 힘들다.


### 계절적인 부 시계열 그래프
![](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/co2seas.gif)

계절적인 부 시계열 그래프는 계절적인 패턴을 더욱 분명하게 보여준다. 이 경우에 이산화탄소 농도는 9월과 10월에 가장 낮다. 9월과 10월부터 6월까지 증가하고 다시 9월까지 감소한다.


### 상자 그래프
![](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/co2boxpl.gif)

계절적인 부 시계열 그래프처럼, 상자 그래프에서도 계절적인 패턴이 상당히 분명하게 나타난다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc443.htm



## 계절적인 부 시계열 그래프
### 목적
계절적인 부 시계열 그래프(클리브랜드Cleveland 1993)는 시계열에서 계절성을 감지하기 위한 도구이다.

이 그래프는 계절성의 주기를 이미 알고 있을 때만 쓸모 있다. 사실 많은 경우에, 주기를 알 수 있다. 예를 들면, 보통 월별 데이터의 주기는 12이다.

주기를 모른다면, 주기를 결정하기 위해 자기 상관 그래프나 분광 그래프(spectral plot)를 사용하면 된다.


### 견본 그래프
![](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/co2seas.gif)

월별 이산화탄소 농도를 나타내는 이 계절적인 부 시계열 그래프에서 뚜렷한 계절성 패턴을 볼 수 있다. 이산화탄소 농도는 5월에 가장 높고, 9월까지 점차 감소한다. 그리고 다시 5월까지 증가한다.

이 그래프로 그룹 사이와 그룹 안의 패턴 모두를 감지할 수 있다.

관측 값이 많다면, 상자 그래프를 사용하길 바란다.


### 정의
계절적인 부 시계열 그래프에는 다음과 같은 요소가 있다.
> 세로축: 응답 변수(response variable)
> 가로축: 시간 순서로 정렬한 계절. 예를 들면, 월별 데이터에서, 모든 1월 값을 시간 순서대로 정렬해서 그리고, 2월이나 다른 월에 대해서도 마찬가지로 그린 것.

한 가지 더, 그룹 평균을 구해서 그룹마다 기준선을 그린다.

그리는 사람은 이 그래프를 그리기 전에 계절적인 패턴의 길이를 정해야 한다. 많은 경우에, 분석하는 사람은 문제와 데이터 수집하는 과정의 맥락에서 알 수 있다. 이산화탄소 데이터처럼, 가끔 이 그래프를 그리기 전에 시계열에서 추세를 없앨 필요도 있다.


### 질문
계절적인 부 시게열 그래프로 다음과 같은 질문에 답할 수 있다.
  1. 데이터가 계절적인 패턴을 나타내는가?
  2. 계절성의 성질이 무엇인가?
  3. 그룹 안의 패턴이 있는가? (예를 들면, 1월과 6월은 패턴이 비슷한가?)
  4. 계절성을 고려할 때 이상점(outlier)이 있는가?


### 중요성
시계열을 분석할 때, 의미있는 계절성 효과 존재 여부를 아는 것은 중요하다. 계절적인 부 시계열 그래프는 계절적인 패턴 존재 여부를 판단할 때 사용하기에 훌륭한 도구이다.


### 관련 기법
연속 순서 그래프
상자 그래프
자기 상관 그래프


### 소프트웨어
몇몇 통계 소프트웨어에서 계절적인 부 시계열 그래프 그리는 기능을 지원한다. 직접 그려주지 않는 대부분의 통계 소프트웨어에서 이 그래프를 그리는 매크로를 작성할 수 있을 것이다. Dataplot 코드와 R 코드로 계절적인 부 시계열 그래프를 그릴 수 있다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc4431.htm



## 6.4.4.4. 단변량 시계열을 다루는 일반적인 방법
시계열을 모델링하는 여러가지 방법이 있다. 아래에서 가장 일반적인 몇 가지 방법들을 살펴보자.

### 추세, 계절적인, 나머지 분해
한 가지 방법은 시계열을 추세, 계절적인 부분, 나머지 성분으로 분해하는 것이다.

삼중 지수 평활법은 이 접근 방식의 한 예이다. 또 다른 예는 클리브랜드Cleveland가 1993년에 언급한 계절적인 *loess*라고 하는 방법인데, 지역적 가중치 최소 제곱법(locally weighted least squares)에 근거한다. 여기에서는 계절적인 *loess*를 다루지 않는다.


### 주파수 기반 방법
과학이나 공학에서 많이 사용하는 또 다른 방법은 시계열을 주파수 영역에서 분석하는 것이다. 이 방법은 빔 편광 사례 연구(beam deflection case study)에서 나타나는 사인 함수(sinusoidal) 형태 데이터를 모델링할 때 사용한다. 시계열의 주파수 분석할 때 분광 그래프를 주로 사용한다.

주파수 기반 방법의 자세한 내용은 블룸필드Bloomfield 1976, 젠킨스와 와츠Jenkins and Watts 1968, 그리고 챗필드 1996를 참고하라.


### 자동회귀(autoregressive, AR) 모델
단변량 시계열을 모델링할 때 흔히 자동회귀(AR) 모델을 사용한다.

X_{t} = \delta + \phi_{1} X_{t-1} + \phi_{2} X_{t-2} + \cdots + \phi_{p} X_{t-1} + A_{t}

여기에서 X_{t}는 시계열, A_{t}는 백색 소음(white noise), 
\delta = \left( 1 - \sum_{i=1}^{p} \phi_{i} \right) \mu ,

\mu는 과정 평균을 의미한다.

자동회귀 모델은 단순히 시계열에서 하나 또는 그 이상의 이전 값에 대한 시계열의 현재 값의 선형 회귀이다. p 값을 AR 모델의 차수라고 한다.

표준 선형 최소 제곱 기법을 포함하여 다양한 기법으로 AR 모델을 분석할 수 있다. 그리고 직관적으로 이해할 수 있다.


### 이동 평균(Moving Average, MA) 모델
이동 평균은 단변량 시계열을 모델링하는 또 하나의 일반적인 접근법이다.

X_{t} = \mu + A_{t} - \theta_{1} A_{t-1} - \theta_{2} A_{t-2} - \cdots - \theta_{q} A_{t-q}

여기에서 X_{t}는 시계열, \mu는 시계열의 평균, A_{t-i}는 백색 소음 항, \theta_{1}, \cdots, \theta_{q}는 모델의 매개변수이다. q값은 MA 모델의 차수라고 한다.

즉, 이동 평균 모델은 개념적으로 시계열에서 백색 소음이나 하나 또는 그 이상의 이전 값의 무작위적 충격에 대한 시계열에서 현재 값의 선형 회귀이다. 어떤 시점에서 무작위적 충격은 동일한 분포(보통 평균이 0이고 상수 척도인 정규 분포)에서 온다고 가정한다. 이 모델에서는 이러한 무작위적 충격이 시계열의 미래 값에 전파된다는 차이가 있다. 왜냐하면 오차 항이 관측할 수 없는 양이라, MA 추정을 맞추는 것은 AR 모델 경우보다 복잡하다. 선형 최소 제곱법 대신 비선형 맞춤(non-linear fitting) 과정을 반복해서 사용해야 한다. MA 모델은 AR 모델보다 직관적으로 해석하기 힘들다.

가끔 자기 상관 함수와 부분 자기 상관 함수가 MA 모델이 더 좋은 선택이라는 것이나 AR과 MA 항을 같은 모델에서 사용해야 한다는 것을 알려준다.

하지만, 모델 뒤의 오차 항은 독립적이어야 하고 단변량 과정의 표준적인 가정을 따라야 한다.


### 박스-젠킨스(Box-Jenkins) 접근법
박스(Box)와 젠킨스(Jenkins) 이동 평균과 자동회귀 접근법을 결합한 기법을 "시게열 분석: 예측과 제어(Time Series Analysis: Forecasting and Control)"라는 책을 통해 대중화하였다(Box, Jenkins, and Reinsel, 1994).

자동회귀와 이동 평균 접근법 둘 다 이미 알려져 있었더라도(원래 Yule이 연구한), 박스와 젠킨스는 두 가지 접근 방식을 결합하여 모델을 감별하고 측정하는 체계적인 방법론을 개발하였다. 이 점이 박스-젠킨스 모델의 강점이다. 다음에 이어지는 몇몇 절에서 이 모델을 자세하게 살펴보겠다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc444.htm


## 6.4.4.5. 박스-젠킨스 모델
### 박스-젠킨스 접근법
박스-젠킨스 ARMA 모델은 (이전에 살펴본 것처럼) AR과 MA 모델을 결합한 것이다.
X_{t} = \delta + \phi_{1} X_{t-1} + \phi_{2} X_{t-2} + \cdots + \phi_{p} X_{t-p} + 
       A_{t} - \theta_{1} A_{t-1} - \theta_{2} A_{t-2} - \cdots - \theta_{q} At - q

위의 식은 AR과 MA 모델에서 봤던 것과 크게 다르지 않다.


### 박스-젠킨스 모델에 대한 첨언
다음은 이 모델에 관한 몇 가지 사항들이다.
1. 박스-젠킨스 모델은 시계열이 정상적(stationary)이라고 가정한다. 박스와 젠킨스는 정상성(stationarity)을 얻기 위해 비-정상적인(non-stationary) 시계열을 빼는 작업을 한 번 이상하기를 권장한다. 그렇게 하면 ARIMA 모델이 된다. 여기에서 "I"는 "통합적인(integrated)"을 의미한다.
2. 몇몇 기법은 시계열의 각 점에서 시계열의 평균을 빼서 변환한다. 이 작업에서 평균이 0인 시계열이 나온다. 이 작업이 필요한지는 모델을 다루는 소프트웨어에 따라 다르다.
3. 계절적인 자동회귀와 계절적인 이동 평균 항을 넣어 박스-젠킨스 모델을 확장할 수 있다. 이렇게 해서 모델이 복잡해지더라도, 계절적인 자동회귀와 계절적인 이동 평균 항에 대한 기본적인 개념은 비-계절적인 자동회귀와 이동 평균 항과 비슷하다.
4. 가장 일반적인 박스-젠킨스 모델에는 차이를 구하는 계산, 자동회귀 항, 이동 평균 항, 계절적인 차이를 구하는 계산, 계절적인 자동회귀 항, 계절적인 이동 평균 항 등이 있다. 하지만 일반적으로 모델링을 할 때는 필요한 항만 추가해야 한다. 이러한 과정에 담긴 수학적인 내용이 좀 더 궁금하다면 Box, Jenkins and Reisel (1994), Chatfield (1996), Brockwell and Davis (2002)를 살펴보길 바란다.


### 박스-젠킨스 모델링 순서
다음은 박스-젠킨스 시계열 모델을 세울 때 중요한 3가지 과정이다.
1. 모델 판별
2. 모델 측정
3. 모델 검증


### 첨언
다음은 박스-젠킨스 모델에 관한 몇 가지 주의 사항이다.
1. 박스-젠킨스 모델은 자동회귀와 이동평균 둘 다 포함하고 있어서 상당히 유연하다.
2. 올드(Wold) 분해 정리(이 글에서 다루지 않는다)에 의하면, 정상 과정은 ARMA 모델로 근사할 수 있다. 근사식을 구하는 작업은 그리 쉽지 않을 것이다.
3. 챗필드Chatfield는 1996년에 추세와 계절적인 성분이 우세한 시계열을 분해하는 방법을 추천하였다.
4. 좋은 ARIMA 모델을 세우려면 회귀법 같이 보통 사용하는 통계 기법에 비해 일반적으로 많은 경험이 필요하다.


### 충분히 긴 시계열이 필요하다
보통 박스-젠킨스 모델을 효과적으로 맞추려면 적당히 긴 시계열이 필요하다. Chatfield는 1996년에 적어도 50개의 관측값이 필요하다고 하였고, 다른 사람들은 적어도 100개 이상이 필요하다고 하였다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc445.htm


## 6.4.4.6 박스-젠킨스 모델 판별
### 정상성과 계절성
박스-젠킨스 모델을 다룰 때 첫 번째 단계는 시계열이 정상적(stationary)인지와 모델링이 필요한 의미있는 계절성이 있는지 확인하는 것이다.


### 정상성 감지하기
정상성은 연속 순서 그래프로 판단할 수 있다. 연속 순서 그래프에서 일정한 위치와 척도가 나타나야 한다. 자가상관 그래프로도 감지할 수 있다. 특별히, 비-정상성이 있다면 종종 자기상관 그래프가 아주 느리게 감소하는 패턴으로 나타난다.


### 계절성 감지하기
계절성(또는 주기성)은 자기상관 그래프, 계절적인 부 시계열 그래프, 분광 그래프 등으로 판단할 수 있다.


### 정상성을 얻기 위한 뺄셈
박스와 젠킨스는 정상성을 얻기 위해 뺄셈 접근법을 추천한다. 하지만, 곡선을 맞추고 원본 데이터에서 맞춘 값을 빼는 것은 박스-젠킨스 모델에서도 사용할 수 있다.


### 계절적인 차이
모델 판별 단계의 목표는 계절성을 감지하는 것과 (만약 계절성이 있다면) 계절적인 자동회귀와 게절적인 이동 평균의 항의 차수를 판별하는 것이다. 많은 시계열의 경우에 주기는 알려져 있고, 한 가지 계절성 항으로도 충분하다. 예를 들면, 월별 데이터의 경우에 계절적인 AR 12 항이나 계절적인 MA 12 항을 보통 추가한다. 박스-젠킨스 모델의 경우에 모델을 맞추기 전에 계절성을 분명하게 제거하지는 않는다. 대신, ARIMA 계산 소프트웨어에 계절적인 항의 차수를 넣는다. 하지만 계절적인 차이를 데이터에 적용하는 것과 자기상관과 부분 자기상관 그래프를 보는 것은 도움이 된다. 이러한 작업은 모델에서 비-계절적인 성분을 판별할 때 도움이 될 수도 있다. 몇몇 경우에, 계절적인 차이가 거의 또는 모든 계절적인 효과를 없애기도 한다.


### p와 q를 판별하기
정상성과 계절성을 조사하고, 그 다음 해야할 일은 자동회귀와 이동 평균 항의 차수를 판별하는 것이다(즉, p와 q).


### 자기상관과 부분 자기상관 그래프
이러한 작업에서는 주로 자기상관 그래프와 부분 자기상관 그래프를 사용한다. 차수를 알 때, 표본 자기상관 그래프와 표본 부분 자기상관 그래프를 이론적인 예측과 비교한다.


### 자동회귀 과정의 차수 p
특별히, AR(1) 과정에서 표본 자기상관 함수는 지수적으로 감소해야 한다. 하지만, 흔히 더 높은 차수의 AR 과정은 지수적으로 감소하는 것과 감쇠하는 사인 함수가 섞여서 나타난다.

높은 차수의 자동회귀 과정에서 표본 자기상관을 볼 때 부분 자기상관 그래프도 같이 볼 필요가 있다. AR(p) 과정의 부분 자기상관은 p+1 이상의 뒤처짐 값부터 0이 된다. 그래서 0에서 벗어나는지 확인하기 위해 표본 부분 자기상관 함수를 볼 필요가 있다. 보통은 표본 부분 자기상관 그래프의 95% 신뢰 구간을 가지고 판단한다(표본 자기상관 그래프를 그려주는 대부분의 소프트웨어에서 신뢰구간도 그려준다). 소프트웨어가 신뢰 구간을 안 그려준다면 근사적으로 ±2/√N 값을 사용해서 그리면 된다. N은 표본 크기이다.


### 이동 평균 과정의 차수 q
MA(q) 과정의 자기상관 함수는 q+1 이상의 뒤처짐 값부터 0이 된다. 표본 자기상관 함수로 어디에서부터 0이 되는지 살펴봐야 한다. 이것은 표본 자기상관 그래프에서 표본 자기상관 함수와 95% 신뢰 구간을 보고 알 수 있다. 자기상관 그래프를 그려주는 대부분의 소프트웨어에서 이러한 신뢰 구간도 그려준다.

일반적으로 표본 부분 자기상관 함수는 이동 평균의 차수를 판별할 때 도움이 안 된다.


### 자기상관 함수의 형태
다음 표는 모델을 판별할 때 표본 자기상관 함수를 어떻게 사용해야 할 지 요약한 것이다.

| 형태  | 사용할 모델 |
|-------|-----------------|
| 0을 향해 지수적으로 감소 | 자동 회귀 모델. 자동회귀 모델의 차수를 판별하기 위해 부분 자기상관 그래프를 사용하자. |
| 양수와 음수가 반복적으로 나타나면서 0으로 감소 | 자동회귀 모델. 자동회귀 모델의 차수를 판별하기 위해 부분 자기상관 그래프를 사용하자. |
| 하나 이상의 뾰족한 막대를 제외하고 나머지는 거의 0 | 이동 평균 모델, 그래프가 0이 되기 시작하는 지점을 차수로 둔다. |
| 몇 시점 후에 감소 | 자동회귀와 이동 평균 모델이 혼합된 것을 사용. |
| 모두 0이거나 0에 가깝다 | 데이터는 무작위적. |
| 일정한 간격에서 높은 값이 나타난다 | 계절적인 자동회귀 항을 넣는다. |
| 0으로 감소하지 않는다 | 정상적(stationary)이지 않은 시계열. |


### 판별하기 어려운 혼합된 모델
실제 상황에서, 표본 자기상관과 부분 자기상관 함수는 확률 변수이고, 이론적인 함수처럼 나타나지 않을 것이다. 어떤 모델을 사용할 지 판별하는 일은 어렵다. 특별히, 혼합된 모델은 판별하기 더 어렵다.

경험이 도움이 되더라도, 이러한 표본 그래프로 좋은 모델을 만들 때 많은 시행 착오를 겪는다. 이러한 이유에서, 최근에는 FPE (Final Prediction Error, 마지막 예측 오차)와 AIC (Akaike Information Criterion, 아카이케 정보 기준) 등 정보기반 기준이 인기를 끌고 있다. 이러한 기법은 모델 판별 과정을 자동화하는데 도움이 된다. 소프트웨어로 이러한 기법을 사용해야 한다. 다행히도, ARIMA 모델링을 지원하는 많은 상용 통게 소프트웨어에서 이러한 기법을 사용할 수 있다.

이러한 기법을 더 알고 싶으면 브록웰과 데이비스의 1987년 2002년 논문을 보라. Brockwell and Davis 1987, 2002


### 예제
아래 시계열 데이터의 그래프를 그려서 초기 모델 판별하는 과정을 살펴보자.
1. 남방 진동 데이터
2. 월별 이산화탄소 농도 데이터


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc446.htm


## 6.4.4.6.1. 남방 진동 데이터에서 모델 판별
### 남방 진동 예제
두 개의 서로 다른 예제에 대해 박스-젠킨스 모델링에서 시계열의 그래프로 모델 판별하는 과정을 살펴보자.

첫 번째 예제는 남방 진동 데이터이다. 먼저, 정상성(stationarity)과 계절성(seasonality)을 고려해야 하는지 판단하기 위해 연속 순서 그래프와 계절적인 부 시계열 그래프를 보자.


### 연속 순서 그래프
![Run sequence plot](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/oscrunsq.gif)

연속 순서 그래프(Run sequence plot)는 정상성을 나타낸다.


### 계절적인 부 시계열 그래프
![Seasonal subseries plot](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/oscseas.gif)

계절적인 부 시계열 그래프에서 계절성이 분명하게 보이지 않는다.

비-정상성이나 계절성이 보이지 않으니, 원 데이터의 자기상관과 부분 자기상관 그래프를 보자.


### 자기상관 그래프
![Autocorrelation Plot](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/oscauto.gif)

자기상관 그래프에서 지수적인 감소와 감쇠 사인 성분이 보인다. 이러한 상황에서는 1보다 큰 차수의 자동회귀 모델이 적절할 것이다. 차수를 결정하기 위해 부분 자기상관 함수를 봐야 한다.


### 부분 자기상관 그래프
![Partial Autocorrelation Plot](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/oscpart.gif)

부분 자기상관 그래프에서 보니 AR(2) 모델이 적절한 것 같다.

요약하면, 계절적인 항이나 추세를 빼거나 제거하는 작업 없는 AR(2) 모델이 적합했다. 모델을 결정하기 전에 꼭 모델을 검증해야 한다.



원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc4461.htm



## 이산화탄소 농도 데이터에서 모델 판별
### 월별 이산화탄소 농도 에제
두 번째 예제는 월별 이산화탄소 농도 데이터이다. 첫 번째 예제처럼, 먼저 정상성을 확인하기 위해 연속 순서 그래프(Run sequence plot)를 보자.


### 연속 순서 그래프
![Run sequence plot](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/co2runsq.gif)

데이터의 연속 순서 그래프에서 증가 추세가 보인다. 단순한 직선으로 증가 추세를 충분히 맞출 수 있을 것 같다.


### 선형 추세 제거
![Date vs residuals](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/co2res.gif)

여기에서 y축은 원 데이터에서 맞춘 직선을 뺀 나머지이다. 선형 추세를 제거하고나니, 연속 순서 그래프는 일정한 위치에 놓였고 일정한 분산을 가지는 것을 볼 수 있다. 이러한 경향은 정상성(stationarity)을 의미한다.

하지만, 그래프에 게절성(seasonality)이 없다. 주기를 정하기 위해 자기상관함수를 확인하고 주기적 부 시계열 그래프를 살펴보자.


### 자기상관 그래프
![autocorrelation plot 자기상관 그래프](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/co2auto.gif)

자기상관 그래프에서 뾰족한 양수와 음수 막대가 반복하여 나타난다. 12 뒤처짐마다 패턴이 반복되는 것도 보인다. 이것은 계절성 효과와 관련 있다.

자기상관 그래프에서 두 선은 자기상관의 통계적인 유의미함에 대한 95%와 99% 신뢰 구간이다.


### 계절적인 부 시계열 그래프
![Seasonal subseries plot 계절적인 부 시계열 그래프](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/co2seas.gif)

그래프에서 의미있는 계절적인 패턴이 분명하게 보이니, 박스-젠킨스 모델을 맞출 때 계절적인 항을 추가해야 한다. 월별 데이터라서 12 뒤처짐 계절적인 자동회귀나(와) 이동 평균 항을 추가하자.

비-계절적 성분을 잘 판별하기 위해 12라는 계절적인 차이를 고려하고 계절적인 차이를 고려한 데이터에서 자기상관 그래프를 보자.


### 계절적인 차이를 고려한 데이터의 자기상관 그래프
![Lag vs autocorrelation 자기상관 그래프](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/co2sauto.gif)

위의 자기상관 그래프에 지수적인 감소와 감쇠 사인 패턴이 혼합된 형태가 보인다. 차수가 1보다 큰 AR 모델이 적절한 것 같다. 차수를 잘 판별하기 위해 부분 자기상관 그래프를 보자.


### 부분 자기상관 그래프
![partial autocorrelation plot of seasonally differenced data](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/co2spart.gif)

부분 자기상관 그래프에서 부분 자기상관이 두 번째 뒤처짐부터 0이 되는 것을 보니 AR(2) 모델이 적합한 것 같다. 어떤 종류의 나머지 계절성을 의미하는 뒤처짐 12도 두드러지게 보인다.

요약하면, 선형 추세를 제거한 데이터에 대한 계절적인 AR(12) 항이 있는 AR(2) 모델이 적합했다. 계절적인 차이를 적용했을 때와 그렇지 않았을 때도 할 수 있을 것이다. 모델을 결정하기 전에 꼭 모델을 검증해야 한다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc4462.htm



## 6.4.4.6.3. 부분 자기상관 그래프
### 목적: 박스-젠킨스 모델 판별
부분 자기상관 그래프(Box and Jenkins, pp. 64-65, 1970)는 박스-젠킨스 모델 판별 과정에서 흔히 사용하는 방법이다.

k 뒤처짐에서 부분 상관은 1 뒤처짐 부터 k-1 뒤처짐으로 설명하지 않은  X_{t}와 X_{t-k} 사이의 자기상관이다.

여기에서 소개하지 않았지만 표본 자기상관에 기초를 두고 부분 자기 상관을 계산하는 다른 알고리즘도 있다. 자세한 내용은 Box, Jenkins, and Reinsel 1970 이나 Brockwell, 1991을 보라.

특별히, 부분 자기상관은 자동회귀 모델의 차수를 판별할 때 사용하면 좋다. AR(p) 과정의 부분 상관은 p+1 이상의 뒤처짐에서 0이다. 표본 자기상관 그래프가 어떤 AR 모델이 적합할 수도 있다는 것을 보여주면, 차수를 판별하기 위해 표본 부분 자기상관 그래프를 확인하자. 부분 자기상관이 0이 되기 시작하는 점을 보자. 이 때 통계적 유의미함에 대한 95% 신뢰 구간을 사용하면 좋다.

근사적으로 부분 자기상관에 대한 95% 신뢰 구간은 ±2/√N 이다.


### 표본 그래프
![](http://www.itl.nist.gov/div898/handbook/pmc/section4/gifs/oscpart.gif)

이 부분 자기상관 그래프에서 1 뒤처짐과 2 뒤처짐(0 뒤처짐의 y값은 항상 1이다)에 대해 분명한 통계적인 유의미함을 볼 수 있다. 이후의 몇몇 뒤처짐은 경계선에 걸친다. 자기상관 그래프에서 AR 모델이 적합하다고 알 수 있으면, AR(2) 모델로 모델링을 시작할 수 있을 것이다. 이것을 AR(3)과 비교해보겠다.


### 정의
부분 자기상관 그래프의 구성 요소이다.
> 수직 축:  h 뒤처짐에서 부분 자기상관 계수
> 수평 축:  시간 뒤처짐 h (h=0,1,2,3, ...).

그리고 여기에 95% 신뢰 구간을 그린다.


### 질문
부분 자기상관 그래프로 다음과 같은 질문에 답할 수 있다.
1. AR 모델이 데이터에 적합한가?
2. AR 모델이 적합하다면, 차수는 얼마인가?


### 관련 기법
자기상관 그래프
연속순서 그래프
분광 그래프


### 사례 연구
Negiz 데이터 사례 연구에 부분 자기상관 그래프가 있다.


### 소프트웨어
많은 통계 소프트웨어에서 부분 자기상관 그래프를 지원한다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc4463.htm



## 박스-젠킨스 모델 측정
### 소프트웨어 사용
박스-젠킨스 모델에서 매개변수를 측정하는 것은 상당히 복잡한 비선형 계산 문제이다. 이러한 이유에서, 매개변수 측정은 박스-젠킨스 모델을 잘 맞추는 좋은 소프트웨어의 몫으로 남겨두자. 다행히, 요즘은 많은 상용 통계 소프트웨어에서 박스-젠킨스 모델로 맞출 수 있다.


### 접근법
주로 비선형 최소 제곱법(non-linear least squares)이나 최대가능성측정법(maximum likelihood estimation)으로 박스-젠킨스 모델을 맞춘다.

일반적으로 최대가능성측정법을 좀 더 많이 사용한다. 전체 박스-젠킨스 모델의 가능성 식(likelihood equations)은 복잡하며 이곳에서 소개하지 않겠다. 자세한 내용은 Brockwell and Davis, 1991을 참조하라.


### 모델 측정 예제
Negiz 사례 연구에서 박스-젠킨스 모델 맞추는 예제를 살펴볼 수 있다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc447.htm


## 박스-젠킨스 모델 진단
### 안정적인 단변량 과정에서 가정
박스-젠킨스 모델에서 모델을 진단하는 것은 비선형 최소 제곱법 맞춤에서 모델을 검증하는 것과 비슷하다.

즉, 오차 항 A_{t}가 정상적인 단변량 과정의 가정을 따른다고 가정한다. 원 데이터에서 맞춘 곡선을 뺀 나머지는 일정한 평균과 분산을 가지는 어떤 고정된 분포에서 나온 백색 소음일 것이다(아니면 분포가 정규 분포면 독립적). 박스-젠킨스 모델이 데이터에 잘 맞는 모델일면, 나머지는 이러한 가정에 잘 맞을 것이다.

이러한 가정이 맞지 않으면, 좀 더 적절한 모델로 맞출 필요가 있다. 즉, 모델 판별 과정으로 돌아가서 좀 더 나은 모델을 찾아야 한다. 나머지 분석이 더 적절한 모델을 만드는 데 단서가 되기를 바란다.


### 나머지에 대한 4개의 그래프
EDA 장에서 이야기한 것처럼, 박스-젠킨스 모델의 나머지가 가정을 따르는지 확인하는 한 가지 방법은 나머지에 대한 4개의 그래프와 나머지의 자기상관 그래프를 그리는 것이다. 박스Box-융Ljung (1978) 통계 값을 살펴볼 수도 있다.

Negiz 데이터 사례 연구에 박스-젠킨스 모델에서 나머지를 분석하는 예가 있다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc448.htm


## 6.4.4.8.1 박스-융 테스트
### 적합성에 대한 테스트
박스-융 테스트(1978)는 시계열이 모델에 잘 맞는지 진단하는 방법이다.

데이터를 ARMA(p,q) 모델로 맞춘 다음, 시계열의 나머지에 테스트를 적용하면 된다. 테스트에서 나머지에 대한 m개의 자기상관을 검사한다. 자기상관이 아주 작다면, 모델이 적합하지 않다고 말할 수 없다는 결과를 준다.

6.4.4.10절에서 나머지 시계열에 박스-융 테스트를 다루는 예제가 있다.


### 정의
일반적으로, 박스-융 테스트는 다음과 같이 정의한다.
H_{0}: 모델이 적합하지 않다는 모습이 안 보인다.
H_{a}: 모델이 적합하지 않다고 보인다.
테스트 통계: 길이 n인 주어진 시계열 Y가 있을 때, 테스트 통계는 다음과 같다.
Q = n(n+2) \sum_{k=1}^{m} \frac{ r_{k}^{2} }{ n - k }
여기에서 r_{k}는 뒤처짐 k에서 측정한 시계열의 자기상관이고, m은 테스트하는 뒤처짐의 갯수이다.

유의미도: \alpha

기각 영역(critical region): 박스-융 테스트는 다음과 같은 경우 귀무 가설(null hypothesis; 유의미하게 모델이 적합하지 않은 경우)을 기각한다.
Q > \chi_{1-\alpha, h}^{2}
여기에서 \chi_{1-\alpha, h}^{2}는 h 자유도와 유의미도 \alpha일 때 카이 제곱 분포표 값이다.

테스트를 나머지에 적용했기 때문에, 반드시 자유도가 h=m-p-q가 되도록 처리해야한다. 여기에서 p와 q는 데이터를 맞추는 ARMA(p,q) 모델에서 매개변수의 수이다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc4481.htm



## 단변량 박스-젠킨스 분석 예제
### 시계열 F
Box, Jenkins, and Reinsel, 1994에 있는 시계열 F 데이터를 살펴보자. 다음 그래프에서 볼 수 있는 것처럼 원본 데이터에는 70개의 점이 있다.

![series F data set](http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc449_r01.gif)

데이터에 계절적인 성분이나 눈에 띄는 추세가 있는 것 같진 않다. (직선을 데이터에 맞춰 시계열의 정상성을 확인했다. 0에서 많이 차이나는 기울기가 보이진 않았다. p-값 = 0.2)


### 모델 판별
데이터를 맞추기 위한 모델의 종류를 정하기 위해 첫 35 뒤처짐에 대한 데이터의 자기상관 함수(ACF)를 보자. 결과와 ACF를 95% 신뢰 구간과 함께 뒤처짐에 따라 그려보자.

| 뒤처짐 |        ACF   |
|------|--------------|
|    0 |  1.000000000 |
|    1 | -0.389878319 |
|    2 |  0.304394082 |
|    3 | -0.165554717 |
|    4 |  0.070719321 |
|    5 | -0.097039288 |
|    6 | -0.047057692 |
|    7 |  0.035373112 |
|    8 | -0.043458199 |
|    9 | -0.004796162 |
|   10 |  0.014393137 |
|   11 |  0.109917200 |
|   12 | -0.068778492 |
|   13 |  0.148034489 |
|   14 |  0.035768581 |
|   15 | -0.006677806 |
|   16 |  0.173004275 |
|   17 | -0.111342583 |
|   18 |  0.019970791 |
|   19 | -0.047349722 |
|   20 |  0.016136806 |
|   21 |  0.022279561 |
|   22 | -0.078710582 |
|   23 | -0.009577413 |
|   24 | -0.073114034 |
|   25 | -0.019503289 |
|   26 |  0.041465024 |
|   27 | -0.022134370 |
|   28 |  0.088887299 |
|   29 |  0.016247148 |
|   30 |  0.003946351 |
|   31 |  0.004584069 |
|   32 | -0.024782198 |
|   33 | -0.025905040 |
|   34 | -0.062879966 |
|   35 |  0.026101117 |

![autocorrelation with 95% confidence limits](http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc449_r02.gif)

ACF 값의 부호가 왔다갔다하고 2 뒤처짐 이후로 빠르게 감소한다. 이것은 AR(2) 모델이 데이터에 적합하다는 의미이다.


### 모델 맞추기
AR(2) 모델을 데이터에 맞추자.

X_{t} = \delta + \phi_{1} X_{t-1} + \phi_{2} X_{t-2} + A_{t}

아래는 모델을 맞춘 결과이다.

| 출처(source)     | 측정    | 표준 오차 |
|----------|---------|-----------|
| \phi_{1} | -0.3198 | 0.1202    |
| \phi_{2} |  0.1797 | 0.1202    |

\delta = 51.1286
나머지 표준 편차 = 10.9599

나머지의 테스트 무작위성:
표준화된 통계
Z = 0.4887, p-값 = 0.625


### 예측
지금까지 다룬 AR(2) 모델로 6 시점 앞까지 예측해보자.

| 시점 | 예측    | 표준 오차 |
|------|---------|-----------|
| 71   | 60.6405 | 10.9479   |
| 72   | 43.0317 | 11.4941   |
| 73   | 55.4274 | 11.9015   |
| 74   | 48.2987 | 12.0108   |
| 75   | 52.8061 | 12.0585   |
| 76   | 50.0835 | 12.0751   |

이전 데이터와 예측한 값을 (90% 신뢰 구간과 함께) 그리면 다음과 같다.

![Series F with Forecasts and 90% Confidence Limits](http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc449_r03.gif)


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc449.htm


## 6.4.4.10. 계절적인 데이터에 대한 박스-젠킨스 분석
### 시계열 G
이 예제는 Box, Jenkins, and Reinsel 1994에 있는 시계열 G 데이터를 사용하여 계절적인 데이터에 대한 박스-젠킨스 시계열 분석에 관한 것이다. 아래 그림에서 볼 수 있듯이 144개의 관측값이 있다.

![Observation vs Series G](http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc44a_r01.gif)

자연 로그 변환으로 일정하지 않은 분산 효과를 없앨 수 있다.

![](http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc44a_r02.gif)

그 다음, 뺄셈으로 시계열에서 추세를 없앤다. 결과 시계열은 다음과 같다.

![](http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc44a_r03.gif)


### 계절성에 대한 자기상관 그래프 분석
적당한 모델을 판별하기 위해, 시계열의 ACF를 그리자.

![](http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc44a_r04.gif)

12 뒤처짐이나 24 뒤처짐 같이 n 주기 떨어져서 아주 큰 자기상관이 보이면, 주기성이 있다고 볼 수 있다. 자기상관을 줄이는 것이 판별 과정의 목적이니 이러한 효과는 제거해야 한다. 그래서 단순하게 차이를 구하는 것으로는 충분하지 않고, 4, 6, 12 같은 특정한 시기에 계절적으로 차이를 구해보자. 이 예제에서는 12로 해보자.

다음은 자연 로그를 취하고, 차이를 구하고, 계절적인 차이를 구해서 그린 시계열 G이다.

![](http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc44a_r05.gif)

계절적인 항의 수가 거의 없다. 예측하는 함수의 형태를 안다면, 게절적인 AR 이나 계절적인 MA 모델에 대해 적절한 수의 항을 고를 수 있다.

박스와 젠킨스의 책, 시계열 분석: 예측과 제어 Time Series Analysis Forecasting and Control (the later edition is Box, Jenkins and Reinsel, 1994), 326-328쪽에 관련 내용이 있다. 잘 모르겠지만 차이를 구하기 전에 증가하는 추세는 있다면, 계절적인 MA 항을 골라서 진단 과정에서 어떻게 나오는지 보라.

시계열 G의 자연 로그 차이와 계절적인 차이의 ACF 그래프는 다음과 같다.

![](http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc44a_r06.gif)

두드러지게 보이는 뾰족한 선 몇 개가 보이지만, 자기상관이 거의 0이다. 이 말은, 계절적인 MA(1)가 적합하다는 이야기이다.


## 모델 맞추기
계절적인 MA(1)을 데이터에 맞춰보자.

X_{t} - \delta = A_{t} + \theta_{1} A_{t-1} + \phi_{1} A_{t-12} + \theta_{1} \phi_{1} A_{t-13}, 

여기에서 \theta_{1}은 MA(1) 매개변수이고 \phi_{1}은 계절적인 매개변수이다. 모델 맞춘 결과는 다음과 같다.

| 측정 | MA(1) | 계절적인 MA(1) |
|------|-------|----------------|
| 매개변수  | -0.4018 | -0.5569 |
| 표준 오차 |  0.0896 |  0.0731 |

나머지 표준 편차 = 0.0367
로그 가능성(Log likelihood) = 244.7
AIC = -483.4

박스-융 테스트로 30 뒤처짐까지 나머지의 무작위성을 확인하였다. 두 측정 매개변수에 대해 기각 영역에 대한 자유도를 맞춰야 한다.

H_{0}: 나머지가 무작위적이다.
H_{a}: 나머지가 무작위적이지 않다.

테스트 통계: Q = 29.4935
유의미도: \alpha = 0.05
자유도: h = 30 - 2 = 28
기각 값: \xi_{1-\alpha, h}^{2} = 41.3371
기각 영역: Q > 41.3371 일 때, H_{0} 기각

박스-융 테스트의 귀무 가설이 기각되지 않았으니, 맞춘 모델이 적절하다고 볼 수 있다.


### 예측
우리의 계절적인 MA(1) 모델로, 12 시점 앞을 예측하고 90% 신뢰 구간도 계산해보자.

| 시점 | 하한값 | 예측 | 상한값   |
|-------|----------|----------|----------|
|   145 | 424.0234 | 450.7261 | 478.4649 |
|   146 | 396.7861 | 426.0042 | 456.7577 |
|   147 | 442.5731 | 479.3298 | 518.4399 |
|   148 | 451.3902 | 492.7365 | 537.1454 |
|   149 | 463.3034 | 509.3982 | 559.3245 |
|   150 | 527.3754 | 583.7383 | 645.2544 |
|   151 | 601.9371 | 670.4625 | 745.7830 |
|   152 | 595.7602 | 667.5274 | 746.9323 |
|   153 | 495.7137 | 558.5657 | 628.5389 |
|   154 | 439.1900 | 497.5430 | 562.8899 |
|   155 | 377.7598 | 430.1618 | 489.1730 |
|   156 | 417.3149 | 477.5643 | 545.7760 |

![](http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc44a_r07.gif)

이 면에서 사용한 모든 분석은 R 코드를 사용해서 재현할 수 있다.


원문: http://www.itl.nist.gov/div898/handbook/pmc/section4/pmc44a.htm